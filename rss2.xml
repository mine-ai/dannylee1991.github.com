<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>studyAI</title>
    <link>http://studyai.site/</link>
    <atom:link href="/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description></description>
    <pubDate>Fri, 16 Mar 2018 11:28:17 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>【翻译】kaggle竞赛 房价预测</title>
      <link>http://studyai.site/2018/03/09/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91kaggle%E7%AB%9E%E8%B5%9B%20%E6%88%BF%E4%BB%B7%E9%A2%84%E6%B5%8B/</link>
      <guid>http://studyai.site/2018/03/09/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91kaggle%E7%AB%9E%E8%B5%9B%20%E6%88%BF%E4%BB%B7%E9%A2%84%E6%B5%8B/</guid>
      <pubDate>Fri, 09 Mar 2018 14:08:55 GMT</pubDate>
      <description>
      
        
        
          &lt;p&gt;&lt;a href=&quot;https://www.kaggle.com/pmarcelino/comprehensive-data-exploration-with-python&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;原文链接&lt;/a&gt;&lt;/p&gt;
&lt;h2 id
        
      
      </description>
      
      <content:encoded><![CDATA[<p><a href="https://www.kaggle.com/pmarcelino/comprehensive-data-exploration-with-python" target="_blank" rel="external">原文链接</a></p><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>如果你有一些R或者Python的经验，并且掌握一些基本的机器学习知识。对于完成机器学习在线课程的数据科学学生来说，这是一个很适合练手的比赛。</p><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>如果让一个想要买房的人来描述他们梦想中的住宅，他们可能不会从地下室天花板的高度或与东西方地铁的距离开始描述。但是这个游乐场比赛的数据集证明，购房者考虑的主要因素中，对价格谈判的影响远远超过卧室或白色栅栏的数量的影响。</p><p>有79个解释变量描述（几乎）爱荷华州埃姆斯的住宅房屋的每个方面，这个竞赛的目标是需要你来预测每个房屋的最终价格。</p><h3 id="实践技能"><a href="#实践技能" class="headerlink" title="实践技能"></a>实践技能</h3><ul><li>创意特征工程</li><li>先进的回归算法技术，如随机森林和梯度提升</li></ul><h3 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h3><p><a href="http://www.amstat.org/publications/jse/v19n3/decock.pdf" target="_blank" rel="external">Ames Housing数据集</a>由Dean De Cock编制，用于数据科学教育。对于那些寻找比Boston Housing数据集更现代化的扩展版本数据集的数据科学家来说，这的确是一个很赞的选择。</p><h2 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h2><h3 id="文件描述"><a href="#文件描述" class="headerlink" title="文件描述"></a>文件描述</h3><ul><li>train.csv - 训练集</li><li>test.csv - 测试集</li><li>data_description.txt - 记录了每个特征的完整描述信息，最初由Dean De Cock编写，后来做了略微的改动</li><li>sample_submission.csv - 来自销售年份和月份的线性回归的基准提交，批量平方英尺和卧室数量（a benchmark submission from a linear regression on year and month of sale, lot square footage, and number of bedrooms）</li></ul><h3 id="字段信息"><a href="#字段信息" class="headerlink" title="字段信息"></a>字段信息</h3><p>以下是您可以在数据描述文件中找到的简要版本。</p><table><thead><tr><th style="text-align:center">字段名</th><th style="text-align:left">英文解释</th><th style="text-align:left">中文解释</th></tr></thead><tbody><tr><td style="text-align:center">SalePrice</td><td style="text-align:left">the property’s sale price in dollars. This is the target variable that you’re trying to predict.</td><td style="text-align:left">房屋的销售价格以美元计价。这是你试图预测的目标变量。</td></tr><tr><td style="text-align:center">MSSubClass</td><td style="text-align:left">The building class</td><td style="text-align:left">建筑类</td></tr><tr><td style="text-align:center">MSZoning</td><td style="text-align:left">The general zoning classification</td><td style="text-align:left">一般分区分类</td></tr><tr><td style="text-align:center">LotFrontage</td><td style="text-align:left">Linear feet of street connected to property</td><td style="text-align:left">连接到财产的街道的线性脚</td></tr><tr><td style="text-align:center">LotArea</td><td style="text-align:left">Lot size in square feet</td><td style="text-align:left">地块面积（平方英尺）</td></tr><tr><td style="text-align:center">Street</td><td style="text-align:left">Type of road access</td><td style="text-align:left">道路通行类型</td></tr><tr><td style="text-align:center">Alley</td><td style="text-align:left">Type of alley access</td><td style="text-align:left">胡同通道的类型</td></tr><tr><td style="text-align:center">LotShape</td><td style="text-align:left">General shape of property</td><td style="text-align:left">财产的一般形状</td></tr><tr><td style="text-align:center">LandContour</td><td style="text-align:left">Flatness of the property</td><td style="text-align:left">物业的平整度</td></tr><tr><td style="text-align:center">Utilities</td><td style="text-align:left">Type of utilities available</td><td style="text-align:left">可用的实用程序类型</td></tr><tr><td style="text-align:center">LotConfig</td><td style="text-align:left">Lot configuration</td><td style="text-align:left">批量配置</td></tr><tr><td style="text-align:center">LandSlope</td><td style="text-align:left">Slope of property</td><td style="text-align:left">财产的倾斜</td></tr><tr><td style="text-align:center">Neighborhood</td><td style="text-align:left">Physical locations within Ames city limits</td><td style="text-align:left">Ames城市限制内的物理位置</td></tr><tr><td style="text-align:center">Condition1</td><td style="text-align:left">Proximity to main road or railroad</td><td style="text-align:left">靠近主干道或铁路</td></tr><tr><td style="text-align:center">Condition2</td><td style="text-align:left">Proximity to main road or railroad (if a second is present)</td><td style="text-align:left">靠近主要道路或铁路（如果存在第二个）</td></tr><tr><td style="text-align:center">BldgType</td><td style="text-align:left">Type of dwelling</td><td style="text-align:left">住宅类型</td></tr><tr><td style="text-align:center">HouseStyle</td><td style="text-align:left">Style of dwelling</td><td style="text-align:left">住宅风格</td></tr><tr><td style="text-align:center">OverallQual</td><td style="text-align:left">Overall material and finish quality</td><td style="text-align:left">总体材料和加工质量</td></tr><tr><td style="text-align:center">OverallCond</td><td style="text-align:left">Overall condition rating</td><td style="text-align:left">总体状况的评价</td></tr><tr><td style="text-align:center">YearBuilt</td><td style="text-align:left">Original construction date</td><td style="text-align:left">原始施工日期</td></tr><tr><td style="text-align:center">YearRemodAdd</td><td style="text-align:left">Remodel date</td><td style="text-align:left">重构日期</td></tr><tr><td style="text-align:center">RoofStyle</td><td style="text-align:left">Type of roof</td><td style="text-align:left">屋顶类型</td></tr><tr><td style="text-align:center">RoofMatl</td><td style="text-align:left">Roof material</td><td style="text-align:left">屋顶材料</td></tr><tr><td style="text-align:center">Exterior1st</td><td style="text-align:left">Exterior covering on house</td><td style="text-align:left">房屋外墙</td></tr><tr><td style="text-align:center">Exterior2nd</td><td style="text-align:left">Exterior covering on house (if more than one material)</td><td style="text-align:left">房屋外墙（如果多于一种）</td></tr><tr><td style="text-align:center">MasVnrType</td><td style="text-align:left">Masonry veneer type</td><td style="text-align:left">Masonry贴面类型</td></tr><tr><td style="text-align:center">MasVnrArea</td><td style="text-align:left">Masonry veneer area in square feet</td><td style="text-align:left">砖石面积平方英尺</td></tr><tr><td style="text-align:center">ExterQual</td><td style="text-align:left">Exterior material quality</td><td style="text-align:left">外部材料质量</td></tr><tr><td style="text-align:center">ExterCond</td><td style="text-align:left">Present condition of the material on the exterior</td><td style="text-align:left">外部材料的现状</td></tr><tr><td style="text-align:center">Foundation</td><td style="text-align:left">Type of foundation</td><td style="text-align:left">基础类型</td></tr><tr><td style="text-align:center">BsmtQual</td><td style="text-align:left">Height of the basement</td><td style="text-align:left">地下室的高度</td></tr><tr><td style="text-align:center">BsmtCond</td><td style="text-align:left">General condition of the basement</td><td style="text-align:left">地下室的一般状况</td></tr><tr><td style="text-align:center">BsmtExposure</td><td style="text-align:left">Walkout or garden level basement walls</td><td style="text-align:left">罢工或花园级地下室的墙壁</td></tr><tr><td style="text-align:center">BsmtFinType1</td><td style="text-align:left">Quality of basement finished area</td><td style="text-align:left">地下室成品面积质量</td></tr><tr><td style="text-align:center">BsmtFinSF1</td><td style="text-align:left">Type 1 finished square feet</td><td style="text-align:left">1型方形脚</td></tr><tr><td style="text-align:center">BsmtFinType2</td><td style="text-align:left">Quality of second finished area (if present)</td><td style="text-align:left">第二个完成区域的质量（如果存在）</td></tr><tr><td style="text-align:center">BsmtFinSF2</td><td style="text-align:left">Type 2 finished square feet</td><td style="text-align:left">2型完成的平方英尺</td></tr><tr><td style="text-align:center">BsmtUnfSF</td><td style="text-align:left">Unfinished square feet of basement area</td><td style="text-align:left">未完成的地下室面积</td></tr><tr><td style="text-align:center">TotalBsmtSF</td><td style="text-align:left">Total square feet of basement area</td><td style="text-align:left">地下室面积的平方英尺</td></tr><tr><td style="text-align:center">Heating</td><td style="text-align:left">Type of heating</td><td style="text-align:left">加热类型</td></tr><tr><td style="text-align:center">HeatingQC</td><td style="text-align:left">Heating quality and condition</td><td style="text-align:left">供热质量和条件</td></tr><tr><td style="text-align:center">CentralAir</td><td style="text-align:left">Central air conditioning</td><td style="text-align:left">中央空调</td></tr><tr><td style="text-align:center">Electrical</td><td style="text-align:left">Electrical system</td><td style="text-align:left">电气系统</td></tr><tr><td style="text-align:center">1stFlrSF</td><td style="text-align:left">First Floor square feet</td><td style="text-align:left">一楼平方英尺</td></tr><tr><td style="text-align:center">2ndFlrSF</td><td style="text-align:left">Second floor square feet</td><td style="text-align:left">二楼平方英尺</td></tr><tr><td style="text-align:center">LowQualFinSF</td><td style="text-align:left">Low quality finished square feet (all floors)</td><td style="text-align:left">低质量成品平方英尺（所有楼层）</td></tr><tr><td style="text-align:center">GrLivArea</td><td style="text-align:left">Above grade (ground) living area square feet</td><td style="text-align:left">以上（地面）生活区平方英尺</td></tr><tr><td style="text-align:center">BsmtFullBath</td><td style="text-align:left">Basement full bathrooms</td><td style="text-align:left">地下室完整的浴室</td></tr><tr><td style="text-align:center">BsmtHalfBath</td><td style="text-align:left">Basement half bathrooms</td><td style="text-align:left">地下室半浴室</td></tr><tr><td style="text-align:center">FullBath</td><td style="text-align:left">Full bathrooms above grade</td><td style="text-align:left">全年以上的浴室</td></tr><tr><td style="text-align:center">HalfBath</td><td style="text-align:left">Half baths above grade</td><td style="text-align:left">半浴半高</td></tr><tr><td style="text-align:center">Bedroom</td><td style="text-align:left">Number of bedrooms above basement level</td><td style="text-align:left">地下室数量</td></tr><tr><td style="text-align:center">Kitchen</td><td style="text-align:left">Number of kitchens</td><td style="text-align:left">厨房数量</td></tr><tr><td style="text-align:center">KitchenQual</td><td style="text-align:left">Kitchen quality</td><td style="text-align:left">厨房质量</td></tr><tr><td style="text-align:center">TotRmsAbvGrd</td><td style="text-align:left">Total rooms above grade (does not include bathrooms)</td><td style="text-align:left">房间总数（不含浴室）</td></tr><tr><td style="text-align:center">Functional</td><td style="text-align:left">Home functionality rating</td><td style="text-align:left">家庭功能评级</td></tr><tr><td style="text-align:center">Fireplaces</td><td style="text-align:left">Number of fireplaces</td><td style="text-align:left">壁炉数量</td></tr><tr><td style="text-align:center">FireplaceQu</td><td style="text-align:left">Fireplace quality</td><td style="text-align:left">壁炉质量</td></tr><tr><td style="text-align:center">GarageType</td><td style="text-align:left">Garage location</td><td style="text-align:left">车库位置</td></tr><tr><td style="text-align:center">GarageYrBlt</td><td style="text-align:left">Year garage was built</td><td style="text-align:left">年建车库</td></tr><tr><td style="text-align:center">GarageFinish</td><td style="text-align:left">Interior finish of the garage</td><td style="text-align:left">车库内部装修</td></tr><tr><td style="text-align:center">GarageCars</td><td style="text-align:left">Size of garage in car capacity</td><td style="text-align:left">车库的车库容量</td></tr><tr><td style="text-align:center">GarageArea</td><td style="text-align:left">Size of garage in square feet</td><td style="text-align:left">平方英尺车库大小</td></tr><tr><td style="text-align:center">GarageQual</td><td style="text-align:left">Garage quality</td><td style="text-align:left">车库质量</td></tr><tr><td style="text-align:center">GarageCond</td><td style="text-align:left">Garage condition</td><td style="text-align:left">车库条件</td></tr><tr><td style="text-align:center">PavedDrive</td><td style="text-align:left">Paved driveway</td><td style="text-align:left">铺设的车道</td></tr><tr><td style="text-align:center">WoodDeckSF</td><td style="text-align:left">Wood deck area in square feet</td><td style="text-align:left">木甲板面积平方英尺</td></tr><tr><td style="text-align:center">OpenPorchSF</td><td style="text-align:left">Open porch area in square feet</td><td style="text-align:left">平方英尺开放门廊</td></tr><tr><td style="text-align:center">EnclosedPorch</td><td style="text-align:left">Enclosed porch area in square feet</td><td style="text-align:left">封闭的门廊面积平方英尺</td></tr><tr><td style="text-align:center">3SsnPorch</td><td style="text-align:left">Three season porch area in square feet</td><td style="text-align:left">三季门廊面积平方英尺</td></tr><tr><td style="text-align:center">ScreenPorch</td><td style="text-align:left">Screen porch area in square feet</td><td style="text-align:left">屏幕门廊面积平方英尺</td></tr><tr><td style="text-align:center">PoolArea</td><td style="text-align:left">Pool area in square feet</td><td style="text-align:left">游泳池面积平方英尺</td></tr><tr><td style="text-align:center">PoolQC</td><td style="text-align:left">Pool quality</td><td style="text-align:left">游泳池质量</td></tr><tr><td style="text-align:center">Fence</td><td style="text-align:left">Fence quality</td><td style="text-align:left">栅栏质量</td></tr><tr><td style="text-align:center">MiscFeature</td><td style="text-align:left">Miscellaneous feature not covered in other categories</td><td style="text-align:left">其他类别未涉及的其他功能</td></tr><tr><td style="text-align:center">MiscVal</td><td style="text-align:left">$Value of miscellaneous feature</td><td style="text-align:left">$杂项功能的值</td></tr><tr><td style="text-align:center">MoSold</td><td style="text-align:left">Month Sold</td><td style="text-align:left">月销售</td></tr><tr><td style="text-align:center">YrSold</td><td style="text-align:left">Year Sold</td><td style="text-align:left">年销售</td></tr><tr><td style="text-align:center">SaleType</td><td style="text-align:left">Type of sale</td><td style="text-align:left">销售类型</td></tr><tr><td style="text-align:center">SaleCondition</td><td style="text-align:left">Condition of sale</td><td style="text-align:left">销售条件</td></tr></tbody></table><h2 id="用Python进行全面的数据探索"><a href="#用Python进行全面的数据探索" class="headerlink" title="用Python进行全面的数据探索"></a>用Python进行全面的数据探索</h2><blockquote><p>Pedro Marcelino 创建</p></blockquote><p><a href="https://www.kaggle.com/pmarcelino/comprehensive-data-exploration-with-python" target="_blank" rel="external">link</a></p><p><strong>‘The most difficult thing in life is to know yourself’</strong></p><p>这句话引用自古希腊米利都的Thales。Thales是希腊/印第安哲学家，数学家和天文学家，被公认为西方文明中第一位享有娱乐和参与科学思想的人（来源：<a href="https://en.wikipedia.org/wiki/Thales" target="_blank" rel="external">https://en.wikipedia.org/wiki/Thales</a>）。</p><p>我不会说了解数据是数据科学中最困难的事情，但这的确是一件非常耗时的事情。很多人可能会忽略这一步骤，就直接下水了。</p><p>所以我试着在下水之前先学会游泳。基于Hair等人（2013）整理的’Examining your data’一章中，我尽我所能对数据进行全面而非详尽的分析。我没有在这个内核中上报严谨的研究过程，但我希望它对社区有所帮助，所以我分享了我如何将这些数据分析原理应用于这个问题的思路。</p><p>尽管我给这些章写了一些奇怪的名字，但我们在这个内核中所做的是：</p><ul><li>1.<strong>理解问题</strong>：我们将研究每个变量，并对这个问题的意义和重要性进行哲学分析。</li><li>2.<strong>单变量研究</strong>：我们只关注因变量（’SalePrice’）并尝试更多地了解它。</li><li>3.<strong>多变量研究</strong>：我们将尝试了解因变量和自变量之间的关系。</li><li>4.<strong>基本的清理工作</strong>：我们将清理数据集并处理缺失的数据，异常值和分类变量。</li><li>5.<strong>测试假设</strong>：我们将检查我们的数据是否符合大多数多元技术所需的假设。</li></ul><p>现在，让我们好好玩吧！</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 邀请人们来参加Kaggle聚会</span></div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> norm</div><div class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</div><div class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</div><div class="line"><span class="keyword">import</span> warnings</div><div class="line">warnings.filterwarnings(<span class="string">'ignore'</span>)</div><div class="line">%matplotlib inline</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 导入数据</span></div><div class="line">df_train = pd.read_csv(<span class="string">'../input/train.csv'</span>)</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 检查描述信息</span></div><div class="line">df_train.columns</div></pre></td></tr></table></figure><p>输出结果</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Index</span>([<span class="string">'Id'</span>, <span class="string">'MSSubClass'</span>, <span class="string">'MSZoning'</span>, <span class="string">'LotFrontage'</span>, <span class="string">'LotArea'</span>, <span class="string">'Street'</span>,</div><div class="line">       <span class="string">'Alley'</span>, <span class="string">'LotShape'</span>, <span class="string">'LandContour'</span>, <span class="string">'Utilities'</span>, <span class="string">'LotConfig'</span>,</div><div class="line">       <span class="string">'LandSlope'</span>, <span class="string">'Neighborhood'</span>, <span class="string">'Condition1'</span>, <span class="string">'Condition2'</span>, <span class="string">'BldgType'</span>,</div><div class="line">       <span class="string">'HouseStyle'</span>, <span class="string">'OverallQual'</span>, <span class="string">'OverallCond'</span>, <span class="string">'YearBuilt'</span>, <span class="string">'YearRemodAdd'</span>,</div><div class="line">       <span class="string">'RoofStyle'</span>, <span class="string">'RoofMatl'</span>, <span class="string">'Exterior1st'</span>, <span class="string">'Exterior2nd'</span>, <span class="string">'MasVnrType'</span>,</div><div class="line">       <span class="string">'MasVnrArea'</span>, <span class="string">'ExterQual'</span>, <span class="string">'ExterCond'</span>, <span class="string">'Foundation'</span>, <span class="string">'BsmtQual'</span>,</div><div class="line">       <span class="string">'BsmtCond'</span>, <span class="string">'BsmtExposure'</span>, <span class="string">'BsmtFinType1'</span>, <span class="string">'BsmtFinSF1'</span>,</div><div class="line">       <span class="string">'BsmtFinType2'</span>, <span class="string">'BsmtFinSF2'</span>, <span class="string">'BsmtUnfSF'</span>, <span class="string">'TotalBsmtSF'</span>, <span class="string">'Heating'</span>,</div><div class="line">       <span class="string">'HeatingQC'</span>, <span class="string">'CentralAir'</span>, <span class="string">'Electrical'</span>, <span class="string">'1stFlrSF'</span>, <span class="string">'2ndFlrSF'</span>,</div><div class="line">       <span class="string">'LowQualFinSF'</span>, <span class="string">'GrLivArea'</span>, <span class="string">'BsmtFullBath'</span>, <span class="string">'BsmtHalfBath'</span>, <span class="string">'FullBath'</span>,</div><div class="line">       <span class="string">'HalfBath'</span>, <span class="string">'BedroomAbvGr'</span>, <span class="string">'KitchenAbvGr'</span>, <span class="string">'KitchenQual'</span>,</div><div class="line">       <span class="string">'TotRmsAbvGrd'</span>, <span class="string">'Functional'</span>, <span class="string">'Fireplaces'</span>, <span class="string">'FireplaceQu'</span>, <span class="string">'GarageType'</span>,</div><div class="line">       <span class="string">'GarageYrBlt'</span>, <span class="string">'GarageFinish'</span>, <span class="string">'GarageCars'</span>, <span class="string">'GarageArea'</span>, <span class="string">'GarageQual'</span>,</div><div class="line">       <span class="string">'GarageCond'</span>, <span class="string">'PavedDrive'</span>, <span class="string">'WoodDeckSF'</span>, <span class="string">'OpenPorchSF'</span>,</div><div class="line">       <span class="string">'EnclosedPorch'</span>, <span class="string">'3SsnPorch'</span>, <span class="string">'ScreenPorch'</span>, <span class="string">'PoolArea'</span>, <span class="string">'PoolQC'</span>,</div><div class="line">       <span class="string">'Fence'</span>, <span class="string">'MiscFeature'</span>, <span class="string">'MiscVal'</span>, <span class="string">'MoSold'</span>, <span class="string">'YrSold'</span>, <span class="string">'SaleType'</span>,</div><div class="line">       <span class="string">'SaleCondition'</span>, <span class="string">'SalePrice'</span>],</div><div class="line">      dtype=<span class="string">'object'</span>)</div></pre></td></tr></table></figure><h3 id="1-那么，我们能得到什么呢？"><a href="#1-那么，我们能得到什么呢？" class="headerlink" title="1.那么，我们能得到什么呢？"></a>1.那么，我们能得到什么呢？</h3><p>为了理解我们的数据，我们可以看看每个变量，并试图理解它们的含义以及与这个问题的相关性。我知道这个工作很耗时，但它会给我们数据集增添一些味道。</p><p>为了在我们的分析中掌握一些规则，我们可以创建一个Excel电子表格，其中包含以下列：</p><ul><li><strong>变量名</strong> - 变量名称。</li><li><strong>类型</strong> - 识别变量的类型。该字段有两种可能的值：’数值型’或’类别型’。“数值型”是指值为数字的变量，而“类别型”是指值为类别的变量。</li><li><strong>细分</strong> - 识别变量的细分。我们可以定义三个可能的部分：building，space或location。当我们说“building”时，我们是指与建筑物的物理特性相关的变量（例如’OverallQual’&lt;总体材料和加工质量&gt;）。当我们说“space”时，我们是指报告房屋空间属性的变量（例如’TotalBsmtSF’&lt;地下室面积的平方英尺&gt;）。最后，当我们说’location’时，我们说的是指能提供有关房屋所在地的信息（例如’Neighborhood’<ames城市限制内的物理位置>）的变量。</ames城市限制内的物理位置></li><li><strong>期望</strong> - 我们对’SalePrice’中的可变影响力的期望。我们可以使用“高”，“中”和“低”作为可能值的分类比例。</li><li><strong>结论</strong> - 在我们快速查看数据后，可以得出关于变量重要性的结论。我们可以保持与“期望”相同的分类尺度。</li><li><strong>评论</strong> - 我们手动赋予的通用评论信息。</li></ul><p>虽然“类型”和“细分”仅供以后使用参考，但“期望”一栏非常重要，因为它有助于我们发展我们的“第六感”。为了填补这个专栏，我们应该阅读所有变量的描述，并逐个问自己：</p><ul><li>当我们买房子时，我们是否考虑这个变量？（例如，当我们想到梦想中的房子时，我们是否在意它的’砌体贴面类型’？）</li><li>如果是这样，这个变量有多重要？（例如，外部材料这个属性的影响到底是“非常大”还是“非常小”，或者是“一般”呢）？</li><li>这些信息是否已在任何其他变量中描述过？（例如，如果’LandContour’&lt;物业的平整度&gt;给出了房产的平坦性，我们是否真的需要知道’LandSlope’&lt;物业的倾斜度&gt;？）。</li></ul><p>经过这个艰巨的练习之后，我们可以过滤电子表格并仔细查看具有“高”’期望’的变量。然后，我们可以绘制出这些变量和’SalePrice’之间的一些散点图，填入’结论’栏，这只是我们预期的修正。</p><p>我经历了这个过程并得出结论，下面的变量可以在这个问题中发挥重要作用：</p><ul><li>OverallQual&lt;总体材料和加工质量&gt;（这是一个我不喜欢的变量，因为我不知道它是如何计算的;你可以把使用所有其他可用变量来预测’OverallQual’来作为一个有趣的练习）。</li><li>YearBuilt&lt;原始施工日期&gt;</li><li>TotalBsmtSF&lt;地下室面积的平方英尺&gt;</li><li>GrLivArea&lt;以上（地面）生活区平方英尺&gt;</li></ul><p>我选择了两个’building’变量（’OverallQual’和’YearBuilt’）和两个’space’变量（’TotalBsmtSF’和’GrLivArea’）。这可能有点意外，因为它违背了房地产的核心，即在房地产中重要的影响因素是“位置”、“位置”和“位置”。对于类别变量，这种快速数据检查过程可能有点苛刻。例如，我预计’Neigborhood’变量更具相关性，但在数据检查之后，我最终排除了它。也许这与使用散点图而不是箱图有关，它更适合分类变量可视化。我们对数据进行可视化的方式通常会影响到我们的结论。</p><p>但是，这个练习的要点是想一想我们的数据和期望值，所以我认为我们达到了目标。现在是’少一点谈话，多一点行动’的时候了。让我们开始吧！</p><h3 id="2-首先要做的是分析’SalePrice’"><a href="#2-首先要做的是分析’SalePrice’" class="headerlink" title="2.首先要做的是分析’SalePrice’"></a>2.首先要做的是分析’SalePrice’</h3><p>‘SalePrice’是我们所追求的理由。就像我们要参加派对时一样。我们总是有一个理由去那里。比如，和女性交往也许就是我们去参加派对的原因。 （免责声明：根据您的喜好将其适应男性，跳舞或酒精）。</p><p>让我们来构建一个使用女性来比喻‘SalePrice’的小故事 – ‘我们如何认识’SalePrice’’的故事。</p><p><em>这一切都始于我们的Kaggle派对。当我们在舞池里寻找一段时间舞伴之后，我们看到一个女孩在酒吧附近使用舞蹈鞋。这说明了她在那里跳舞。我们花了很多时间进行预测建模并参与分析竞赛，因此与女孩谈话并不是我们的主要能力之一。即便如此，我们试了一下：</em></p><p><em>嗨，我是Kaggly！你呢？ ‘SalePrice’？多么美丽的名字！你知道’SalePrice’，你能给我提供一些关于你的数据吗？我刚刚开发了一个模型来计算两个人之间关系成功的可能性。我想在我们身上试一试！’</em></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 描述性统计数据汇总</span></div><div class="line">df_train[<span class="string">'SalePrice'</span>].describe()</div></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">count</span>      1460<span class="selector-class">.000000</span></div><div class="line"><span class="selector-tag">mean</span>     180921<span class="selector-class">.195890</span></div><div class="line"><span class="selector-tag">std</span>       79442<span class="selector-class">.502883</span></div><div class="line"><span class="selector-tag">min</span>       34900<span class="selector-class">.000000</span></div><div class="line">25%      129975<span class="selector-class">.000000</span></div><div class="line">50%      163000<span class="selector-class">.000000</span></div><div class="line">75%      214000<span class="selector-class">.000000</span></div><div class="line"><span class="selector-tag">max</span>      755000<span class="selector-class">.000000</span></div><div class="line"><span class="selector-tag">Name</span>: <span class="selector-tag">SalePrice</span>, <span class="selector-tag">dtype</span>: <span class="selector-tag">float64</span></div></pre></td></tr></table></figure><p><em>很好……看起来你的最低价格大于零。很棒！你没有那些会毁掉我的模特的个人特质！你可以寄给我一些你的照片吗？……就像你在沙滩上……或者在健身房里自拍的那种一样？“</em></p><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 直方图</div><div class="line"><span class="selector-tag">sns</span><span class="selector-class">.distplot</span>(df_train[<span class="string">'SalePrice'</span>]);</div></pre></td></tr></table></figure><p><img src="/img/18_03_11/001.png" alt=""></p><p><em>啊!我看到你在出门的时候使用了seaborn化妆……太优雅了！我也看到你：</em></p><ul><li><strong><em>偏离正态分布。</em></strong></li><li><strong><em>有明显的正偏态。</em></strong></li><li><strong><em>显示尖锐度。</em></strong></li></ul><p><em>这很有趣！’SalePrice’，你能给我你的身体指标吗？’</em></p><figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 偏度和峰度</span></div><div class="line"><span class="keyword">print</span>(<span class="string">"Skewness: %f"</span> % df_train[<span class="string">'SalePrice'</span>].skew())</div><div class="line"><span class="keyword">print</span>(<span class="string">"Kurtosis: %f"</span> % df_train[<span class="string">'SalePrice'</span>].kurt())</div></pre></td></tr></table></figure><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">Skewness:</span> <span class="number">1.882876</span></div><div class="line"><span class="symbol">Kurtosis:</span> <span class="number">6.536282</span></div></pre></td></tr></table></figure><p><em>‘Amazing！如果我的爱情计算器是正确的，我们的成功概率是97.834657％。我想我们应该再见面！如果下星期五有空，请留下我的电话号码并给我打电话。再见！</em></p><h4 id="‘SalePrice’，她的好友和她的兴趣"><a href="#‘SalePrice’，她的好友和她的兴趣" class="headerlink" title="‘SalePrice’，她的好友和她的兴趣"></a>‘SalePrice’，她的好友和她的兴趣</h4><p><em>选择你将要战斗的地形是重要的军事智慧。离开了“SalePrice”，我们就去了她的Facebook。请注意，这不是在跟踪她。我们只是对她做深入的研究。</em></p><p><em>据她介绍，我们有一些共同的朋友。除了Chuck Norris之外，我们都知道’GrLivArea’和’TotalBsmtSF’。此外，我们也有共同的兴趣，如’OverallQual’和’YearBuilt’。这看起来我们有希望！</em></p><p><em>为了充分利用我们的研究成果，我们将首先仔细研究我们的共同朋友的概况，然后我们将重点关注我们的共同利益。</em></p><p><strong>与数值变量的关系</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 绘制 GrLivArea/SalePrice 的散点图</span></div><div class="line">var = <span class="string">'GrLivArea'</span></div><div class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>], df_train[var]], axis=<span class="number">1</span>)</div><div class="line">data.plot.scatter(x=var, y=<span class="string">'SalePrice'</span>, ylim=(<span class="number">0</span>,<span class="number">800000</span>));</div></pre></td></tr></table></figure><p><img src="/img/18_03_11/002.png" alt=""></p><p><em>嗯……看起来’SalePrice’和’GrLivArea’是真正的老朋友，具有线性关系。</em></p><p><em>那么’TotalBsmtSF’呢？</em></p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta"># 绘制 TotalBsmtSF/SalePrice 的散点图</span></div><div class="line"><span class="title">var</span> = '<span class="type">TotalBsmtSF'</span></div><div class="line"><span class="class"><span class="keyword">data</span> = pd.concat([<span class="title">df_train</span>['<span class="type">SalePrice</span>'], <span class="title">df_train</span>[<span class="title">var</span>]], <span class="title">axis</span>=1)</span></div><div class="line"><span class="class"><span class="keyword">data</span>.plot.scatter(<span class="title">x</span>=<span class="title">var</span>, <span class="title">y</span>='<span class="type">SalePrice</span>', <span class="title">ylim</span>=(0,800000));</span></div></pre></td></tr></table></figure><p><img src="/img/18_03_11/003.png" alt=""></p><p><em>‘TotalBsmtSF’也是’SalePrice’的好朋友，但这似乎是一种更加情感化的关系！在一开始的时候，一切似乎都很顺利，突然间，他们的关系呈现出强烈的线性（指数？）反应，一切都在变化。此外，很明显，有时’TotalBsmtSF’本身就会关闭，并且对’SalePrice’给予零分。</em></p><p><strong>与类别特征的关系</strong></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 绘制 OverallQual/SalePrice 的箱图</span></div><div class="line"><span class="attr">var</span> = 'OverallQual'</div><div class="line"><span class="attr">data</span> = pd.concat([df_train['SalePrice'], df_train[var]], <span class="attr">axis=1)</span></div><div class="line">f, <span class="attr">ax</span> = plt.subplots(<span class="attr">figsize=(8,</span> <span class="number">6</span>))</div><div class="line"><span class="attr">fig</span> = sns.boxplot(<span class="attr">x=var,</span> <span class="attr">y="SalePrice",</span> <span class="attr">data=data)</span></div><div class="line">fig.axis(<span class="attr">ymin=0,</span> <span class="attr">ymax=800000);</span></div></pre></td></tr></table></figure><p><img src="/img/18_03_11/004.png" alt=""></p><p><em>像所有漂亮女孩一样，’SalePrice’很享受’OverallQual’。提醒自己：考虑麦当劳是否适合作为第一次约会的场所。</em></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="attr">var</span> = 'YearBuilt'</div><div class="line"><span class="attr">data</span> = pd.concat([df_train['SalePrice'], df_train[var]], <span class="attr">axis=1)</span></div><div class="line">f, <span class="attr">ax</span> = plt.subplots(<span class="attr">figsize=(16,</span> <span class="number">8</span>))</div><div class="line"><span class="attr">fig</span> = sns.boxplot(<span class="attr">x=var,</span> <span class="attr">y="SalePrice",</span> <span class="attr">data=data)</span></div><div class="line">fig.axis(<span class="attr">ymin=0,</span> <span class="attr">ymax=800000);</span></div><div class="line">plt.xticks(<span class="attr">rotation=90);</span></div></pre></td></tr></table></figure><p><img src="/img/18_03_11/005.png" alt=""></p><p><em>虽然这不是一个强烈的趋势，但我认为相比旧的东西，’SalePrice’更喜欢在新的东西上花钱</em></p><p><strong>注意：</strong>我们不知道’SalePrice’是否处于不变价格。不变的价格试图消除通货膨胀的影响。如果’SalePrice’价格不是固定的，那么它应该是这样的，因为多年来价格是可比的。</p><p><strong>综上所述</strong>，我们可以得出以下结论：</p><ul><li>‘GrLivArea’和’TotalBsmtSF’似乎与’SalePrice’线性相关。这两种关系都是积极的，这意味着随着一个变量增加，另一个变量也增加。在’TotalBsmtSF’的情况下，我们可以看到线性关系的斜率特别高。</li><li>‘OverallQual’和’YearBuilt’似乎也与’SalePrice’有关。在’OverallQual’的情况下，这种关系似乎更强一些，箱子图显示了销售价格随整体质量的变化情况。</li></ul><p>我们只分析了四个变量，但还有很多其他的我们应该分析。这里的诀窍似乎是选择正确的特征（特征选择），而不是它们之间复杂关系的定义（特征工程）。</p><h3 id="3-保持客观，理性工作"><a href="#3-保持客观，理性工作" class="headerlink" title="3.保持客观，理性工作"></a>3.保持客观，理性工作</h3><p>到现在为止，我们只是遵循我们的直觉，分析了我们认为重要的变量。尽管我们努力为我们的分析提供客观性，但我们必须说，我们的出发点是主观的。</p><p>作为一名工程师，我对这种方法感到不舒服。我所有的教育都是为了培养一个训练有素的头脑，能够抵挡主观性的思维。因为如果在结构工程中扮演主观性的角色，你会发现主观的想法是站不住脚的。</p><p>所以，让我们克服惯性，做一个更客观的分析。</p><p><strong>‘等离子汤’</strong></p><p>“一开始除了等离子汤以外没有其他任何东西。在我们研究宇宙学的时候，我们知道这些短暂的时刻，在很大程度上是推测得出的。然而，科学已经根据今天宇宙已知的情况设计了可能发生的事情的一些草图。’（来源：<a href="http://umich.edu/~gs265/bigbang.htm" target="_blank" rel="external">http://umich.edu/~gs265/bigbang.htm</a>）</p><p>为了探索宇宙，我们将从一些实用的食谱开始，以理解我们的“等离子汤”：</p><ul><li>相关矩阵（热图样式）。</li><li>‘SalePrice’相关矩阵（放大热图样式）。</li><li>最相关的变量之间的散点图（move like Jagger样式）</li></ul><p><strong>相关矩阵（热图样式）</strong></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#相关矩阵</span></div><div class="line"><span class="attr">corrmat</span> = df_train.corr()</div><div class="line">f, <span class="attr">ax</span> = plt.subplots(<span class="attr">figsize=(12,</span> <span class="number">9</span>))</div><div class="line">sns.heatmap(corrmat, <span class="attr">vmax=.8,</span> <span class="attr">square=True);</span></div></pre></td></tr></table></figure><p><img src="/img/18_03_11/006.png" alt=""></p><p>在我看来，这张热图是快速了解我们的“等离子汤”及其关系的最佳方式。 （谢谢你@seaborn！）</p><p>乍一看，有两个红色的正方形引起了我的注意。第一个引用’TotalBsmtSF’和’1stFlrSF’变量，第二个引用’GarageX’变量。两种情况都表明这些变量之间的相关性有多大。实际上，这种相关性非常强，可以表明多重共线性的情况。如果我们考察了这些变量，我们可以得出相同的结论。热图非常适合检测这种情况，并且在像我们这样的特征选择占主导地位的问题中，它们是必不可少的工具。</p><p>另一件引起我注意的事情是’SalePrice’相关性。我们可以看到我们众所周知的’GrLivArea’，’TotalBsmtSF’和’OverallQual’这样明显的变量在向我们说“Hi！”，但我们也可以看到许多其他应该考虑的变量。这就是我们接下来要做的。</p><p><strong>‘SalePrice’相关矩阵（放大热图样式）</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># SalePrice相关矩阵</span></div><div class="line">k = <span class="number">10</span> <span class="comment">#热图的变量数</span></div><div class="line">cols = corrmat.nlargest(k, <span class="string">'SalePrice'</span>)[<span class="string">'SalePrice'</span>].index</div><div class="line">cm = np.corrcoef(df_train[cols].values.T)</div><div class="line">sns.set(font_scale=<span class="number">1.25</span>)</div><div class="line">hm = sns.heatmap(cm, cbar=<span class="keyword">True</span>, annot=<span class="keyword">True</span>, square=<span class="keyword">True</span>, fmt=<span class="string">'.2f'</span>, annot_kws=&#123;<span class="string">'size'</span>: <span class="number">10</span>&#125;, yticklabels=cols.values, xticklabels=cols.values)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/img/18_03_11/007.png" alt=""></p><p>根据我们的水晶球显示，这些是与“SalePrice”最相关的变量。因此我得出以下结论：</p><ul><li>OverallQual’，’GrLivArea’和’TotalBsmtSF’与’SalePrice’密切相关。需要检查！</li><li>‘GarageCars’和’GarageArea’也是一些与强度相关的变量。但是，正如我们在最后一点所讨论的那样，车库所能容纳的车辆数量是车库面积的结果。’GarageCars’和’GarageArea’就像孪生兄弟。你永远无法区分它们。因此，我们只需要分析其中的一个变量（我们可以保留’GarageCars’，因为它与’SalePrice’的关联性更高）。</li><li>‘TotalBsmtSF’和’1stFloor’也似乎是双胞胎兄弟。我们可以只保留’TotalBsmtSF’（重新阅读’那么，我们能得到什么呢？’部分）。</li><li>‘FullBath’?? 真的需要吗?</li><li>‘TotRmsAbvGrd’和’GrLivArea’，再次是双胞胎兄弟。这是来自切尔诺贝利的数据集吗？</li><li>啊……’YearBuilt’……看起来’YearBuilt’与’SalePrice’略有关联。老实说，对于’YearBuilt’变量来说，我是有一些额外的顾虑的，因为这让我觉得我们应该做一些时间序列分析来分析这一变量。我会把这个问题作为你的homework。</li></ul><p>我们继续看散点图。</p><p>‘SalePrice’和相关变量之间的散点图（move like Jagger style）</p><p>前方高能！我第一次看到这些散点图的时候，我完全震惊了。</p><p>在如此短的空间里有如此多的信息.​​…..这真是太神奇了。再一次谢谢@seaborn！你让我’move like Jagger’！</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 绘制散点图</span></div><div class="line">sns.set()</div><div class="line">cols = [<span class="string">'SalePrice'</span>, <span class="string">'OverallQual'</span>, <span class="string">'GrLivArea'</span>, <span class="string">'GarageCars'</span>, <span class="string">'TotalBsmtSF'</span>, <span class="string">'FullBath'</span>, <span class="string">'YearBuilt'</span>]</div><div class="line">sns.pairplot(df_train[cols], size = <span class="number">2.5</span>)</div><div class="line">plt.show();</div></pre></td></tr></table></figure><p><img src="/img/18_03_11/008.png" alt=""></p><p>虽然我们已经知道一些主要的变量，但这个巨大的散点图给了我们关于变量关系的一个合理的解释。</p><p>我们可能会对’TotalBsmtSF’和’GrLiveArea’组成的散点图感兴趣。在这个图中，我们可以看到许多点画出了一条线，几乎就像一个边界。这种结果是完全有道理的，并且大多数的点保持在该线以下。地下室的面积可以等于地面上的居住面积，但预计地下室面积不会超过地上居住面积（除非你想购买的是地堡）。</p><p>关于’SalePrice’和’YearBuilt’的情况也可以让我们进一步思考。在“点云”的底部，我们看到一个看起来几乎是一个指数函数的曲线。我们也可以在’点云’的上限中看到同样的趋势。另外，请注意过去几年中的一系列点数是如何保持在这个极限之上的（我只是想说价格增速正在变快）。</p><p>好吧，现在我们已经完成了足够多的罗夏测试。让我们来探讨下一步的内容：缺失数据！</p><h3 id="4-缺失的数据"><a href="#4-缺失的数据" class="headerlink" title="4.缺失的数据"></a>4.缺失的数据</h3><p>在考虑缺失数据时的几个重要问题：</p><ul><li>缺失的数据有多普遍？</li><li>丢失数据是随机现象的还是有一定的规律？</li></ul><p>这些问题的答案很重要，因为缺少数据可能意味着样本量减少。这可能会使我们的分析工作无法进行。此外，从实质的角度来看，我们需要确保缺失的数据流程没有偏见，并确保没有将一些不易洞察的事实所隐藏。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 缺失数据</span></div><div class="line">total = df_train.isnull().sum().sort_values(ascending=<span class="keyword">False</span>)</div><div class="line">percent = (df_train.isnull().sum()/df_train.isnull().count()).sort_values(ascending=<span class="keyword">False</span>)</div><div class="line">missing_data = pd.concat([total, percent], axis=<span class="number">1</span>, keys=[<span class="string">'Total'</span>, <span class="string">'Percent'</span>])</div><div class="line">missing_data.head(<span class="number">20</span>)</div></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left"></th><th style="text-align:left">Total</th><th style="text-align:left">Percent</th></tr></thead><tbody><tr><td style="text-align:left">PoolQC</td><td style="text-align:left">1453</td><td style="text-align:left">0.995205</td></tr><tr><td style="text-align:left">MiscFeature</td><td style="text-align:left">1406</td><td style="text-align:left">0.963014</td></tr><tr><td style="text-align:left">Alley</td><td style="text-align:left">1369</td><td style="text-align:left">0.937671</td></tr><tr><td style="text-align:left">Fence</td><td style="text-align:left">1179</td><td style="text-align:left">0.807534</td></tr><tr><td style="text-align:left">FireplaceQu</td><td style="text-align:left">690</td><td style="text-align:left">0.472603</td></tr><tr><td style="text-align:left">LotFrontage</td><td style="text-align:left">259</td><td style="text-align:left">0.177397</td></tr><tr><td style="text-align:left">GarageCond</td><td style="text-align:left">81</td><td style="text-align:left">0.055479</td></tr><tr><td style="text-align:left">GarageType</td><td style="text-align:left">81</td><td style="text-align:left">0.055479</td></tr><tr><td style="text-align:left">GarageYrBlt</td><td style="text-align:left">81</td><td style="text-align:left">0.055479</td></tr><tr><td style="text-align:left">GarageFinish</td><td style="text-align:left">81</td><td style="text-align:left">0.055479</td></tr><tr><td style="text-align:left">GarageQual</td><td style="text-align:left">81</td><td style="text-align:left">0.055479</td></tr><tr><td style="text-align:left">BsmtExposure</td><td style="text-align:left">38</td><td style="text-align:left">0.026027</td></tr><tr><td style="text-align:left">BsmtFinType2</td><td style="text-align:left">38</td><td style="text-align:left">0.026027</td></tr><tr><td style="text-align:left">BsmtFinType1</td><td style="text-align:left">37</td><td style="text-align:left">0.025342</td></tr><tr><td style="text-align:left">BsmtCond</td><td style="text-align:left">37</td><td style="text-align:left">0.025342</td></tr><tr><td style="text-align:left">BsmtQual</td><td style="text-align:left">37</td><td style="text-align:left">0.025342</td></tr><tr><td style="text-align:left">MasVnrArea</td><td style="text-align:left">8</td><td style="text-align:left">0.005479</td></tr><tr><td style="text-align:left">MasVnrType</td><td style="text-align:left">8</td><td style="text-align:left">0.005479</td></tr><tr><td style="text-align:left">Electrical</td><td style="text-align:left">1</td><td style="text-align:left">0.000685</td></tr><tr><td style="text-align:left">Utilities</td><td style="text-align:left">0</td><td style="text-align:left">0.000000</td></tr></tbody></table><p>让我们分析一下这个表里的信息，来理解如何处理丢失的数据。</p><p>我们会考虑当超过15％的数据丢失时，删除相应的变量并假设它从来都不存在。这意味着在这些情况下，我们不会尝试填补缺失数据。按照这个逻辑，我们应该删除一组变量（例如’PoolQC’，’MiscFeature’，’Alley’等）。这么做的重点是：我们会错过这些数据吗？我不这么认为。这些变量中没有一个看起来很重要，因为其中大多数不是我们在购买房屋时考虑的方面（或许这就是这些数据会缺失的原因？）。此外，仔细观察变量，像’PoolQC’，’MiscFeature’和’FireplaceQu’这样的变量是异常值的强有力候选者，所以我们很乐意删除它们。</p><p>在其余的案例中，我们可以看到“GarageX”系列的变量具有相同数量的缺失数据。我敢打赌，缺少的数据来自同一组观察结果（我不会检查它，缺失值只有5％的占比）。由于表示关于车库信息的最重要信息的字段是“GarageCars”，并且考虑到我们只是谈论了5％的缺失数据，所以我将删除提及的“GarageX”变量。同样的逻辑适用于’BsmtX’变量。</p><p>关于’MasVnrArea’和’MasVnrType’，我们可以认为这些变量不是必需的。此外，它们与已经考虑过的“YearBuilt”和“OverallQual”有很强的相关性。因此，如果我们删除’MasVnrArea’和’MasVnrType’这两个变量，我们不会丢失信息。</p><p>最后，我们在’Electrical’中有一个缺失的观察。由于这只是一个观察，我们将删除此记录并保留该变量。</p><p>总之，为了处理缺失的数据，我们将删除所有缺少数据的变量，但变量’Electrical’除外。在’Electrical’中，我们只需删除缺少数据的观察结果。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 缺失数据处理</span></div><div class="line">df_train = df_train.drop((missing_data[missing_data[<span class="string">'Total'</span>] &gt; <span class="number">1</span>]).index,<span class="number">1</span>)</div><div class="line">df_train = df_train.drop(df_train.loc[df_train[<span class="string">'Electrical'</span>].isnull()].index)</div><div class="line">df_train.isnull().sum().max() <span class="comment">#just checking that there's no missing data missing...</span></div></pre></td></tr></table></figure><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">0</span></div></pre></td></tr></table></figure><h3 id="离群值！"><a href="#离群值！" class="headerlink" title="离群值！"></a>离群值！</h3><p>离群值也是我们应该意识到的。为什么？因为异常值可以显着影响我们的模型，并且可以成为宝贵的信息来源，为某些特定行为提供解释。</p><p>离群值是一个复杂的问题，值得给与更多关注。在这里，我们将通过“SalePrice”的标准偏差和一组散点图进行快速分析。</p><p><strong>单变量分析</strong></p><p>这里主要关心的是建立一个阈值，将观测定义为异常值。为此，我们将标准化数据。在此情况下，数据标准化意味着将数据值转换为平均值为0，标准偏差为1。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="section"># 标准化数据</span></div><div class="line">saleprice<span class="emphasis">_scaled = StandardScaler().fit_</span>transform(df_train[<span class="string">'SalePrice'</span>][<span class="symbol">:,np.newaxis</span>]);</div><div class="line">low<span class="emphasis">_range = saleprice_</span>scaled[<span class="string">saleprice_scaled[:,0</span>].argsort()][:10]</div><div class="line">high<span class="emphasis">_range= saleprice_</span>scaled[<span class="string">saleprice_scaled[:,0</span>].argsort()][-10:]</div><div class="line">print('outer range (low) of the distribution:')</div><div class="line">print(low_range)</div><div class="line">print('\nouter range (high) of the distribution:')</div><div class="line">print(high_range)</div></pre></td></tr></table></figure><figure class="highlight inform7"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">outer range (low) <span class="keyword">of</span> the distribution:</div><div class="line"><span class="comment">[<span class="comment">[-1.83820775]</span></span></div><div class="line"> <span class="comment">[-1.83303414]</span></div><div class="line"> <span class="comment">[-1.80044422]</span></div><div class="line"> <span class="comment">[-1.78282123]</span></div><div class="line"> <span class="comment">[-1.77400974]</span></div><div class="line"> <span class="comment">[-1.62295562]</span></div><div class="line"> <span class="comment">[-1.6166617 ]</span></div><div class="line"> <span class="comment">[-1.58519209]</span></div><div class="line"> <span class="comment">[-1.58519209]</span></div><div class="line"> <span class="comment">[-1.57269236]</span>]</div><div class="line"></div><div class="line">outer range (high) <span class="keyword">of</span> the distribution:</div><div class="line"><span class="comment">[<span class="comment">[3.82758058]</span></span></div><div class="line"> <span class="comment">[4.0395221 ]</span></div><div class="line"> <span class="comment">[4.49473628]</span></div><div class="line"> <span class="comment">[4.70872962]</span></div><div class="line"> <span class="comment">[4.728631  ]</span></div><div class="line"> <span class="comment">[5.06034585]</span></div><div class="line"> <span class="comment">[5.42191907]</span></div><div class="line"> <span class="comment">[5.58987866]</span></div><div class="line"> <span class="comment">[7.10041987]</span></div><div class="line"> <span class="comment">[7.22629831]</span>]</div></pre></td></tr></table></figure><p>对’SalePrice’的新衣服，感觉如何？：</p><ul><li>低范围值与0相似且不太远。</li><li>高范围值远离0，大概是7.多的值。</li></ul><p>目前，我们不会将这些值视为异常值，但我们应该小心这两个值。</p><p><strong>双变量分析</strong></p><p>我们已经了解了以下散点图。但是，当我们从新的角度来看事物时，总会有一些东西需要发现。正如Alan Kay所说，“视角的改变相当于提高80点智商”。</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta"># 双变量分析SalePrice/GrLivArea</span></div><div class="line"><span class="title">var</span> = '<span class="type">GrLivArea'</span></div><div class="line"><span class="class"><span class="keyword">data</span> = pd.concat([<span class="title">df_train</span>['<span class="type">SalePrice</span>'], <span class="title">df_train</span>[<span class="title">var</span>]], <span class="title">axis</span>=1)</span></div><div class="line"><span class="class"><span class="keyword">data</span>.plot.scatter(<span class="title">x</span>=<span class="title">var</span>, <span class="title">y</span>='<span class="type">SalePrice</span>', <span class="title">ylim</span>=(0,800000));</span></div></pre></td></tr></table></figure><p><img src="/img/18_03_11/009.png" alt=""></p><p>它所揭示的是：</p><ul><li>这两个变量中，更大的’GrLivArea’的数据看起来很奇怪，这些较大的’GrLivArea’离群了。我们可以推测为什么会发生这种情况。也许这些样本是农业领域的，这样想可以解释低价的原因。我不确定这一点，但我确信这两点并不代表典型案例。因此，我们将它们定义为异常值并删除它们。</li><li>顶部的两个观察结果是那些7.多的那两个，我们应该小心处理这些观察结果。他们看起来像两个特殊情况，但他们似乎正在追随上涨的趋势。出于这个原因，我们会保留它们。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">＃ 删除点</div><div class="line">df_train.sort_values(by = <span class="string">'GrLivArea'</span>, ascending = <span class="keyword">False</span>)[:<span class="number">2</span>]</div><div class="line">df_train = df_train.drop(df_train[df_train[<span class="string">'Id'</span>] == <span class="number">1299</span>].index)</div><div class="line">df_train = df_train.drop(df_train[df_train[<span class="string">'Id'</span>] == <span class="number">524</span>].index)</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 双变量分析SalePrice/GrLivArea</span></div><div class="line">var = <span class="string">'TotalBsmtSF'</span></div><div class="line">data = pd.concat([df_train[<span class="string">'SalePrice'</span>], df_train[var]], axis=<span class="number">1</span>)</div><div class="line">data.plot.scatter(x=var, y=<span class="string">'SalePrice'</span>, ylim=(<span class="number">0</span>,<span class="number">800000</span>));</div></pre></td></tr></table></figure><p><img src="/img/18_03_11/010.png" alt=""></p><p>我们可以想象消除一些观察结果（例如TotalBsmtSF&gt; 3000的结果），但我认为这么做不值得。我们可以接受这些值，所以我们不会做任何事情。</p><h3 id="5-硬核部分"><a href="#5-硬核部分" class="headerlink" title="5.硬核部分"></a>5.硬核部分</h3><p>在Ayn Rand的小说“阿特拉斯耸耸肩”中，有一个经常重复的问题：John Galt是谁？本书很大一部分是关于寻求发现这个问题的答案。</p><p>我现在体会到了Rand的感受，’SalePrice’是谁呢？</p><p>这个问题的答案在于测试多变量分析统计基础的假设。我们已经做了一些数据清理，并发现了很多关于’SalePrice’的信息。现在是深入了解’SalePrice’如何符合统计假设的时候了，这些假设使我们能够应用多元技术。</p><p>根据Hair et al. (2013)，我们应该测试四个假设：</p><ul><li><strong>正态性</strong> - 当我们谈论正态性时，我们的意思是数据应该看起来像正态分布。这很重要，因为几个统计测试依赖于此（例如t-statistics）。在本练习中，我们将检查’SalePrice’的单变量正态性（这是一种有限的方法）。请记住，单变量正态性并不能确保多元正态性（这是我们想要的），但这么做是有帮助的。需要考虑的另一个细节是，在大样本（&gt; 200个观测值）的情况下，正态性不是一个重要的问题。但是，如果我们解决正态性问题，就可以避免很多其他问题（例如异质性），这就是我们进行这种分析的主要原因。</li><li><strong>方差齐性</strong> - 希望我写的是对的。 方差齐性指的是“假设变量（一个或多个）在预测​​变量范围内表现出相同的方差水平”（Hair et al。，2013）。考虑方差齐性是合理的，因为我们希望误差项在自变量的所有值中都是相同的。</li><li><strong>线性</strong> - 评估线性的最常见方法是检查散点图并搜索线性模式。如果模式不是线性的，那么可以尝试探索数据转换。但是，在这里我们去转换数据，因为我们看到的大多数散点图似乎都具有线性关系。</li><li><strong>缺少相关错误</strong> - 如定义所示，相关的错误发生在一个错误与另一个错误相关时。例如，如果一个正误差系统地产生负误差，则意味着这些变量之间存在关系。这通常以时间序列发生，其中一些模式与时间相关。我们在这里不会涉及这一点。但是，如果您检测到某些内容，请尝试添加一个可以解释您获得的效果的变量。这是相关错误的最常见解决方案。</li></ul><p>你认为猫王会对这个漫长的解释说些什么？ ‘请少一点谈话，多一点行动’？可能……顺便说一下，你知道Elvis最后一次承受的重大的打击是什么吗？</p><p>(…)</p><p>是浴室的地板。</p><p><strong>寻找正态性</strong></p><p>这里的要点是以非常精益的方式测试’SalePrice’。我们将这样做：</p><ul><li><strong>直方图</strong> - 峰度和偏度。</li><li><strong>正态概率图</strong> - 数据分布应该紧跟代表正态分布的对角线。</li></ul><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 直方图和正态概率图</span></div><div class="line">sns.distplot(df_train['SalePrice'], <span class="attr">fit=norm);</span></div><div class="line"><span class="attr">fig</span> = plt.figure()</div><div class="line"><span class="attr">res</span> = stats.probplot(df_train['SalePrice'], <span class="attr">plot=plt)</span></div></pre></td></tr></table></figure><p><img src="/img/18_03_11/011.png" alt=""></p><p><img src="/img/18_03_11/012.png" alt=""></p><p>好吧，’SalePrice’不服从正态分布。它显示’顶峰’呈现出正偏斜状态，并且不遵循对角线。</p><p>但一切都没有丢失。简单的数据转换可以解决问题。这是您可以在统计书籍中学到的很棒的东西之一：如果是正偏态，使用log函数转换通常效果不错。当我发现这一点时，我感觉自己就像一个霍格沃茨的学生发现了一个新的咒语一样。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">＃ 应用log函数转换</div><div class="line">df_train[<span class="string">'SalePrice'</span>] = np.log(df_train[<span class="string">'SalePrice'</span>])</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 转换的直方图和正态概率分布图</span></div><div class="line">sns.distplot(df_train[<span class="string">'SalePrice'</span>], fit=norm);</div><div class="line">fig = plt.figure()</div><div class="line">res = stats.probplot(df_train[<span class="string">'SalePrice'</span>], plot=plt)</div></pre></td></tr></table></figure><p><img src="/img/18_03_11/013.png" alt=""></p><p><img src="/img/18_03_11/014.png" alt=""></p><p>完成！让我们来看看’GrLivArea’的情况。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">＃ 直方图和正态概率分布图</div><div class="line">sns.distplot(df_train[<span class="string">'GrLivArea'</span>], fit=norm);</div><div class="line">fig = plt.figure()</div><div class="line">res = stats.probplot(df_train[<span class="string">'GrLivArea'</span>], plot=plt)</div></pre></td></tr></table></figure><p><img src="/img/18_03_11/015.png" alt=""></p><p><img src="/img/18_03_11/016.png" alt=""></p><p>看起来有点歪…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 数据转换</span></div><div class="line">df_train[<span class="string">'GrLivArea'</span>] = np.log(df_train[<span class="string">'GrLivArea'</span>])</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 转换的直方图和正态概率分布图</span></div><div class="line">sns.distplot(df_train[<span class="string">'GrLivArea'</span>], fit=norm);</div><div class="line">fig = plt.figure()</div><div class="line">res = stats.probplot(df_train[<span class="string">'GrLivArea'</span>], plot=plt)</div></pre></td></tr></table></figure><p><img src="/img/18_03_11/017.png" alt=""></p><p><img src="/img/18_03_11/018.png" alt=""></p><p>下一个…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 直方图和正态概率分布图</span></div><div class="line">sns.distplot(df_train[<span class="string">'TotalBsmtSF'</span>], fit=norm);</div><div class="line">fig = plt.figure()</div><div class="line">res = stats.probplot(df_train[<span class="string">'TotalBsmtSF'</span>], plot=plt)</div></pre></td></tr></table></figure><p><img src="/img/18_03_11/019.png" alt=""></p><p><img src="/img/18_03_11/020.png" alt=""></p><p>好的，现在我们要处理几个大麻烦了：</p><ul><li>总体来说，数据分布呈现偏斜状态。</li><li>有大量的零值观察（比如没有地下室的房屋）。</li><li>0是不能求log的，这是一个很大的问题。</li></ul><p>为了在这里应用log转换，我们将创建一个变量来获得有或没有地下室（二进制变量）的效果。然后，我们将对所有非零观测值进行对数转换，忽略零值。这样我们就可以转换数据，而不会失去有或没有地下室的影响。</p><p>我不确定这种方法是否正确。但这对我来说似乎是正确的。这就是我所说的“高风险工程”。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 为新变量创建列（一个足够了，因为它是一个二进制分类特征）</span></div><div class="line"><span class="comment"># 如果 area&gt;0 值为1，否则 值为0</span></div><div class="line">df_train[<span class="string">'HasBsmt'</span>] = pd.Series(len(df_train[<span class="string">'TotalBsmtSF'</span>]), index=df_train.index)</div><div class="line">df_train[<span class="string">'HasBsmt'</span>] = <span class="number">0</span> </div><div class="line">df_train.loc[df_train[<span class="string">'TotalBsmtSF'</span>]&gt;<span class="number">0</span>,<span class="string">'HasBsmt'</span>] = <span class="number">1</span></div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 数据转换</span></div><div class="line">df_train.loc[df_train[<span class="string">'HasBsmt'</span>]==<span class="number">1</span>,<span class="string">'TotalBsmtSF'</span>] = np.log(df_train[<span class="string">'TotalBsmtSF'</span>])</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 直方图和正态概率分布图</span></div><div class="line">sns.distplot(df_train[df_train[<span class="string">'TotalBsmtSF'</span>]&gt;<span class="number">0</span>][<span class="string">'TotalBsmtSF'</span>], fit=norm);</div><div class="line">fig = plt.figure()</div><div class="line">res = stats.probplot(df_train[df_train[<span class="string">'TotalBsmtSF'</span>]&gt;<span class="number">0</span>][<span class="string">'TotalBsmtSF'</span>], plot=plt)</div></pre></td></tr></table></figure><p><img src="/img/18_03_11/021.png" alt=""></p><p><img src="/img/18_03_11/022.png" alt=""></p><p><strong>在第一次尝试中寻找“方差齐性”</strong></p><p>测试两个度量变量的同方差性的最佳方法是图形化。对不同特征使用相同的分布方式，生成锥形（样本在一侧分布的少，另一侧分布的多）或钻石（大量点分布在中心区域）等形状的分布情况。</p><p>绘制SalePrice’和’GrLivArea’的分布：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">＃散点图</div><div class="line">plt.scatter(df_train[<span class="string">'GrLivArea'</span>], df_train[<span class="string">'SalePrice'</span>]);</div></pre></td></tr></table></figure><p><img src="/img/18_03_11/023.png" alt=""></p><p>此散点图的旧版本（在对数转换之前）具有圆锥形状（返回并检查’SalePrice’和相关变量之间的散点图（move like Jagger style））。如您所见，当前的散点图不再具有圆锥形状。这是正态化的力量！只要确保一些变量的正态性，我们解决了同方差问题。</p><p>我们继续检查’SalePrice’和’TotalBsmtSF’。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">＃散点图</div><div class="line">plt.scatter(df_train[df_train[<span class="string">'TotalBsmtSF'</span>]&gt;<span class="number">0</span>][<span class="string">'TotalBsmtSF'</span>], df_train[df_train[<span class="string">'TotalBsmtSF'</span>]&gt;<span class="number">0</span>][<span class="string">'SalePrice'</span>]);</div></pre></td></tr></table></figure><p><img src="/img/18_03_11/024.png" alt=""></p><p>总的来说，’SalePrice’在’TotalBsmtSF’范围内表现出相等的变化水平。Cool!</p><h3 id="Last-but-not-the-least-虚拟变量"><a href="#Last-but-not-the-least-虚拟变量" class="headerlink" title="Last but not the least, 虚拟变量"></a>Last but not the least, 虚拟变量</h3><p>简单模式。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">＃ 虚拟变量转换</div><div class="line">df_train = pd.get_dummies(df_train)</div></pre></td></tr></table></figure><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>到了练习的最后部分。</p><p>在整个这个kernel中，我们实践了许多由Hair等人提出的策略。 （2013年）。我们对变量进行了哲学研究，我们单独分析了“SalePrice”，并且与最相关的变量进行了分析，我们处理了缺失的数据和异常值，我们测试了一些基本的统计假设，甚至将分类变量转换为虚拟变量。 Python帮助我们轻松完成了很多工作。</p><p>但是我们的任务还没有结束。别忘了，我们的故事还停留在对’SalePrice’的Facebook的研究那一步呢。现在是时候打电话给’SalePrice’并邀请她共进晚餐。试着预测她的行为。你认为她是一个喜欢正规化线性回归方法的女孩吗？或者你认为她喜欢合奏方法？或者也许别的东西？</p><p>答案由你找出。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="http://pmarcelino.com/" target="_blank" rel="external">作者blog</a></p><p><a href="https://www.amazon.com/Multivariate-Data-Analysis-Joseph-Hair/dp/0138132631" target="_blank" rel="external">Hair等人，2013，多变量数据分析，第7版</a></p><h2 id="致谢-1"><a href="#致谢-1" class="headerlink" title="致谢"></a>致谢</h2><p>感谢JoãoRico的审阅。</p>]]></content:encoded>
      
      <comments>http://studyai.site/2018/03/09/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91kaggle%E7%AB%9E%E8%B5%9B%20%E6%88%BF%E4%BB%B7%E9%A2%84%E6%B5%8B/#disqus_thread</comments>
    </item>
    
    <item>
      <title>【原创】AI-QI量化平台搭建爬坑笔记-小心偏斜类问题</title>
      <link>http://studyai.site/2017/12/20/%E3%80%90%E5%8E%9F%E5%88%9B%E3%80%91AI-QI%E9%87%8F%E5%8C%96%E5%B9%B3%E5%8F%B0%E6%90%AD%E5%BB%BA%E7%88%AC%E5%9D%91%E7%AC%94%E8%AE%B0-%E5%B0%8F%E5%BF%83%E5%81%8F%E6%96%9C%E7%B1%BB%E9%97%AE%E9%A2%98/</link>
      <guid>http://studyai.site/2017/12/20/%E3%80%90%E5%8E%9F%E5%88%9B%E3%80%91AI-QI%E9%87%8F%E5%8C%96%E5%B9%B3%E5%8F%B0%E6%90%AD%E5%BB%BA%E7%88%AC%E5%9D%91%E7%AC%94%E8%AE%B0-%E5%B0%8F%E5%BF%83%E5%81%8F%E6%96%9C%E7%B1%BB%E9%97%AE%E9%A2%98/</guid>
      <pubDate>Wed, 20 Dec 2017 06:54:00 GMT</pubDate>
      <description>
      
        
        
          &lt;blockquote&gt;
&lt;p&gt;原创文章，转载请注明出处&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;首先安利一波广告：&lt;/p&gt;
&lt;p&gt;最近利用业余时间搭建了一个智能量化投资平台，代码已经全部开源：&lt;a href=&quot;https://github.com/DannyLee1991/a
        
      
      </description>
      
      <content:encoded><![CDATA[<blockquote><p>原创文章，转载请注明出处</p></blockquote><p>首先安利一波广告：</p><p>最近利用业余时间搭建了一个智能量化投资平台，代码已经全部开源：<a href="https://github.com/DannyLee1991/ai_qi" target="_blank" rel="external">https://github.com/DannyLee1991/ai_qi</a></p><p>目前已经实现的功能有：</p><ul><li>数据的抓取（数据来源<a href="tushare.org">tushare</a>}）</li></ul><p><img src="/img/17_12_20/001.png" alt=""></p><ul><li>数据入库，并在界面上可以执行sql操作</li></ul><p><img src="/img/17_12_20/002.png" alt=""></p><ul><li>数据可视化</li></ul><p><img src="/img/17_12_20/003.png" alt=""><br><img src="/img/17_12_20/004.png" alt=""></p><ul><li>数据集创建</li></ul><p>数据集管理</p><p><img src="/img/17_12_20/005.png" alt=""></p><p>数据集创建</p><p><img src="/img/17_12_20/006.png" alt=""></p><p>数据集查看</p><p><img src="/img/17_12_20/005.png" alt=""></p><ul><li>数据预处理</li></ul><p>// 暂无界面</p><p>正在开发中的功能：</p><ul><li>数据建模</li><li>接入交易接口</li><li>…</li></ul><p>各个已有的功能目前也只是做了部分实现，先把各个环节打通，然后在慢慢填充。最终的目标是利用机器学习算法来预测分析各种投资数据。</p><p>欢迎各位大牛拍砖指导~</p><hr><p>好，以上不是本文的重点，本文重点是这两天在建立第一个模型过程中遇到的一个坑。</p><hr><h3 id="数据集介绍"><a href="#数据集介绍" class="headerlink" title="数据集介绍"></a>数据集介绍</h3><p>第一个模型，我准备使用日交易数据来预测次日的涨跌幅度，使用的数据来自日交易数据表：</p><p><img src="/img/17_12_20/008.png" alt=""></p><p>这是对应的原始数据集详情信息：</p><p><img src="/img/17_12_20/009.png" alt=""></p><p>其中  除了X的<strong>‘date’(时间)</strong>特征之外，其他的特征都是float类型的数据。暂时先剔除这一维度的数据，所以最后用来训练的X的shape是<code>(292583, 15)</code>。</p><p>Y的shape不变，是<code>(292583, 1)</code>。</p><p>Y的数据类型也是float。</p><blockquote><p>这里先解释一下<strong>Y</strong>的含义：Y对应的数据是涨跌幅，但和与之对应的X的数据并不是同一天的，这里<strong>日期间隔1</strong>的含义是Y取的是相对于X的数据的时间的下一日的数据，因为我们要预测的是次日涨跌幅。</p></blockquote><p>对于分类模型，我们的Y应该是类别标签，而不能是连续型数值，所以我们应该把当前的float类型的Y，转换成某种类别标签来表示。</p><p>一种很容易理解的方式，就是float转int，简单粗暴：</p><p>eg:</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Y = [<span class="number">1.1</span>, <span class="number">2.6</span>, <span class="number">3.5</span>, <span class="number">-1.8</span>, ...]</div></pre></td></tr></table></figure><p>转换为int之后</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Y = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">-1</span>, ...]</div></pre></td></tr></table></figure><p>但这里有一个小坑，负数的标签在带入到tensorflow中训练是会报错的，所以把标签数据+10，全部转为大于等于0的数据，处理之后的效果为：</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Y = [<span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">9</span>, ...]</div></pre></td></tr></table></figure><p>在经过上述的预处理之后，Y被处理成了21个类别（-10到10之间一共21个int值）的数据集。</p><p>然后就是将数据打乱，按照6:2:2的比例将数据分割为<strong>训练集</strong>、<strong>验证集</strong>和<strong>测试集</strong>。</p><hr><h3 id="带入训练"><a href="#带入训练" class="headerlink" title="带入训练"></a>带入训练</h3><p>仿照tensorflow的<a href="https://www.tensorflow.org/get_started/estimator" target="_blank" rel="external">demo</a>，将数据带入一个DNN模型，进行训练。</p><p>没有进行什么特殊的调参，最终准确率竟然达到了接近50%！</p><p><img src="/img/17_12_20/010.png" alt=""></p><p>要知道这是21个类别的分类问题，50%的准确率已经远远高于均匀分布情况下随机选择的准确率（大约是4.8%）了。</p><p>于是我觉得21类数据，准确率就能达到这么高，那如果我将类别改为2类，准确率应该会大幅提升的。</p><p>于是我重新将Y的数据改为了0和1两种类别，0代表跌1代表涨。</p><p>但实际情况，并没有好很多，准确率大概达到52%左右。</p><p>看到这种结果，第一时间，我是怀疑自己代码有没有哪里写错，但经过排查，并没有发现有什么异常。</p><p>后来，又尝试将数据分为4类，8类来训练，得到的结果依然是50%左右。</p><p>WTF？</p><h3 id="原来是偏斜类在搞鬼"><a href="#原来是偏斜类在搞鬼" class="headerlink" title="原来是偏斜类在搞鬼"></a>原来是偏斜类在搞鬼</h3><blockquote><p><a href="http://t.cn/RSh83NE" target="_blank" rel="external">这里有篇关于偏斜类的文章</a>，值得一看。</p></blockquote><p>我将原始数据绘制成柱状图之后，发现了问题所在：</p><p><img src="/img/17_12_20/011.png" alt=""></p><p>数据在各个类别上<strong>并不是均匀分布的</strong>，大部分都聚集在了10（对应涨跌幅为0%）的位置上。而我训练出来的模型，带入一批测试数据后，预测结果也都是10。</p><p>也就是说，我们的分类器，就算完全没有识别能力，输入任何值，输出的结果都是10这种类别，那么这个分类器就有50%的准确率！！！</p><p>这是一个很傻的结果，就好比一个完全不懂股票的人，你问他某只股票明天会不会涨，他只要回答：“明天不涨不跌”，那么他就有50%的概率猜对了。</p><p>好吧，这并不是我们想要的效果，那么我们如何避免这种情况呢？</p><h3 id="想办法让各个类别的数据呈现均匀分布"><a href="#想办法让各个类别的数据呈现均匀分布" class="headerlink" title="想办法让各个类别的数据呈现均匀分布"></a>想办法让各个类别的数据呈现均匀分布</h3><p>我想到的办法是在标签数据生成的过程中做些手脚。使得各个类别的数据呈现出均匀分布的情况。</p><p>所以我写了一个函数，用来将数据处理成均匀分布的标签：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> math</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">uniform_distribution</span><span class="params">(Y, n, l_type=<span class="string">'b'</span>)</span>:</span></div><div class="line">    <span class="string">'''</span></div><div class="line">    平均分布</div><div class="line"></div><div class="line">    将Y按照值的大小进行均匀分布的方式分割成n等分</div><div class="line">    并生成对应的类别标签</div><div class="line"></div><div class="line">    :param Y: 数据源  形状为(num,)</div><div class="line">    :param n: 将数据分割为n等分</div><div class="line">    :param l_type: 分割数据之后 标签的取值类别&#123;'b','s','n'&#125;</div><div class="line">                'b' : 类别标签为区间范围内的最大值</div><div class="line">                's' : 类别标签为区间范围内的最小值</div><div class="line">                'n' : 类别标签为区间范围内的平均值</div><div class="line"></div><div class="line">    :return:</div><div class="line"></div><div class="line">    eg：</div><div class="line">    Y = [1,1,2,3,4,4,5,6,7]</div><div class="line">    n = 5</div><div class="line">    l_type = 'b'</div><div class="line">    result = [1 1 3 3 4 4 6 6 7]</div><div class="line"></div><div class="line">    n = 3</div><div class="line">    l_type = 's'</div><div class="line">    result = [1 1 1 2 2 2 4 4 4]</div><div class="line"></div><div class="line">    n = 5</div><div class="line">    l_type = 'n'</div><div class="line">    result = [ 1.   1.   2.   2.   3.5  3.5  5.   5.   6.5]</div><div class="line"></div><div class="line">    '''</div><div class="line"></div><div class="line">    node_list = gen_nodelist(Y, n)</div><div class="line">    toY = []</div><div class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> Y:</div><div class="line">    <span class="comment"># 这里虽然得到的是float类型的值，但tensorflow的类别标签 只能是int类型，所以将对应的索引作为标签值来使用</span></div><div class="line">        index, val = get_label(num, node_list, l_type)</div><div class="line">        toY.append(index)</div><div class="line"></div><div class="line">    print(<span class="string">"node list &gt;&gt;"</span>)</div><div class="line">    print(node_list)</div><div class="line">    <span class="keyword">return</span> np.array(toY)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_label</span><span class="params">(num, node_list, l_type)</span>:</span></div><div class="line">    <span class="comment"># 下限</span></div><div class="line">    lm = <span class="number">0</span></div><div class="line">    <span class="comment"># 上限</span></div><div class="line">    um = <span class="number">0</span></div><div class="line">    target = <span class="number">0</span></div><div class="line"></div><div class="line">    <span class="comment"># 节点区间是(lm,um]</span></div><div class="line">    <span class="keyword">for</span> index, node <span class="keyword">in</span> enumerate(node_list):</div><div class="line">        <span class="keyword">if</span> node &gt;= num:</div><div class="line">            <span class="keyword">if</span> index &gt; <span class="number">0</span>:</div><div class="line">                um = node</div><div class="line">                lm = node_list[index - <span class="number">1</span>]</div><div class="line">                target = index</div><div class="line">                <span class="keyword">break</span></div><div class="line"></div><div class="line">    label = <span class="string">''</span></div><div class="line">    <span class="keyword">if</span> l_type == <span class="string">'s'</span>:</div><div class="line">        label = lm</div><div class="line">    <span class="keyword">elif</span> l_type == <span class="string">'b'</span>:</div><div class="line">        label = um</div><div class="line">    <span class="keyword">elif</span> l_type == <span class="string">'n'</span>:</div><div class="line">        label = (lm + um) / <span class="number">2</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> target, label</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_nodelist</span><span class="params">(data, n)</span>:</span></div><div class="line">    <span class="string">'''</span></div><div class="line">    生成节点列表  节点是指示数据的分割点</div><div class="line">    :param data: 原始数据 需要被分割的数据</div><div class="line">    :param n: 分割的份数</div><div class="line">    :return:</div><div class="line">    '''</div><div class="line">    sorted_list = sorted(data)</div><div class="line">    size = len(sorted_list)</div><div class="line">    node_list = []</div><div class="line">    block_size = math.ceil(size / n)</div><div class="line">    <span class="keyword">for</span> index, item <span class="keyword">in</span> enumerate(sorted_list):</div><div class="line">        <span class="keyword">if</span> (index + <span class="number">1</span>) % block_size == <span class="number">0</span>:</div><div class="line">            node_list.append(item)</div><div class="line">        <span class="keyword">elif</span> index == <span class="number">0</span>:</div><div class="line">            node_list.append(item)</div><div class="line">        <span class="keyword">elif</span> index == size - <span class="number">1</span>:</div><div class="line">            node_list.append(item)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> node_list</div></pre></td></tr></table></figure><p>用这个函数重新预处理我们的Y，这里我们将Y分为10种类别，Y按照以下的标签值，重新赋值：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="number">-10.08</span>, <span class="number">-2.3900000000000001</span>, <span class="number">-1.4199999999999999</span>, <span class="number">-0.84999999999999998</span>, <span class="number">-0.40999999999999998</span>, <span class="number">0.0</span>, <span class="number">0.28999999999999998</span>, <span class="number">0.68999999999999995</span>, <span class="number">1.24</span>, <span class="number">2.25</span>, <span class="number">10.16</span>]</div></pre></td></tr></table></figure><p>可以看到，这些标签值并不是线性的，这是因为我们的数据不是均匀分布的。</p><p>按照这种标签处理之后，将数据绘制成柱状图后，如下：</p><p><img src="/img/17_12_20/012.png" alt=""></p><p>接下来带入训练就比较正常了。</p>]]></content:encoded>
      
      <comments>http://studyai.site/2017/12/20/%E3%80%90%E5%8E%9F%E5%88%9B%E3%80%91AI-QI%E9%87%8F%E5%8C%96%E5%B9%B3%E5%8F%B0%E6%90%AD%E5%BB%BA%E7%88%AC%E5%9D%91%E7%AC%94%E8%AE%B0-%E5%B0%8F%E5%BF%83%E5%81%8F%E6%96%9C%E7%B1%BB%E9%97%AE%E9%A2%98/#disqus_thread</comments>
    </item>
    
    <item>
      <title>10分钟上手Pandas</title>
      <link>http://studyai.site/2017/11/30/10%E5%88%86%E9%92%9F%E4%B8%8A%E6%89%8BPandas/</link>
      <guid>http://studyai.site/2017/11/30/10%E5%88%86%E9%92%9F%E4%B8%8A%E6%89%8BPandas/</guid>
      <pubDate>Thu, 30 Nov 2017 03:17:00 GMT</pubDate>
      <description>
      
        
        
          &lt;p&gt;&lt;a href=&quot;http://pandas.pydata.org/pandas-docs/stable/10min.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;原文地址&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这是关于pandas的一个简短的介绍，主要面向的是
        
      
      </description>
      
      <content:encoded><![CDATA[<p><a href="http://pandas.pydata.org/pandas-docs/stable/10min.html" target="_blank" rel="external">原文地址</a></p><p>这是关于pandas的一个简短的介绍，主要面向的是新手用户。你可以在<a href="http://pandas.pydata.org/pandas-docs/stable/cookbook.html#cookbook" target="_blank" rel="external">Cookbook</a>查看更多复杂的使用方式。</p><p>通常情况下，我们按照下面这种方式引入：</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="type">In</span> [<span class="number">1</span>]: <span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"></div><div class="line"><span class="type">In</span> [<span class="number">2</span>]: <span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line"><span class="type">In</span> [<span class="number">3</span>]: <span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div></pre></td></tr></table></figure><h2 id="对象创建"><a href="#对象创建" class="headerlink" title="对象创建"></a>对象创建</h2><p>见<a href="http://pandas.pydata.org/pandas-docs/stable/dsintro.html#dsintro" target="_blank" rel="external">数据结构介绍部分</a>。</p><p>通过传入一个list的数值来创建一个<code>Series</code>，pandas会创建一个默认的整数索引:</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">In</span> [<span class="number">4</span>]: s = pd.Series([<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,np.nan,<span class="number">6</span>,<span class="number">8</span>])</div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">5</span>]: s</div><div class="line"><span class="keyword">Out</span>[<span class="number">5</span>]: </div><div class="line"><span class="number">0</span>    <span class="number">1.0</span></div><div class="line"><span class="number">1</span>    <span class="number">3.0</span></div><div class="line"><span class="number">2</span>    <span class="number">5.0</span></div><div class="line"><span class="number">3</span>    <span class="meta">NaN</span></div><div class="line"><span class="number">4</span>    <span class="number">6.0</span></div><div class="line"><span class="number">5</span>    <span class="number">8.0</span></div><div class="line"><span class="symbol">dtype:</span> <span class="meta">float64</span></div></pre></td></tr></table></figure><p>通过传入一个numpy数组来创建一个’DataFrame’，带有一个datetime的索引以及标签列:</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">6</span>]: dates = pd.date_range('<span class="number">20130101</span>', periods=<span class="number">6</span>)</div><div class="line"></div><div class="line">In [<span class="number">7</span>]: dates</div><div class="line">Out[<span class="number">7</span>]: </div><div class="line">DatetimeIndex(['<span class="number">2013-01-01</span>', '<span class="number">2013-01-02</span>', '<span class="number">2013-01-03</span>', '<span class="number">2013-01-04</span>',</div><div class="line">               '<span class="number">2013-01-05</span>', '<span class="number">2013-01-06</span>'],</div><div class="line">              dtype='datetime64[ns]', freq='D')</div><div class="line"></div><div class="line">In [<span class="number">8</span>]: df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>), index=dates, columns=list('ABCD'))</div><div class="line"></div><div class="line">In [<span class="number">9</span>]: df</div><div class="line">Out[<span class="number">9</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C         D</div><div class="line"><span class="number">2013-01-01</span>  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span></div><div class="line"><span class="number">2013-01-02</span>  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></div><div class="line"><span class="number">2013-01-03</span> -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span></div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></div><div class="line"><span class="number">2013-01-05</span> -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span></div><div class="line"><span class="number">2013-01-06</span> -<span class="number">0.673690</span>  <span class="number">0.113648</span> -<span class="number">1.478427</span>  <span class="number">0.524988</span></div></pre></td></tr></table></figure><p>通过传入一个可以转换为类series（series-like）的字典对象来创建一个<code>DataFrame</code>:</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">In</span> [<span class="number">10</span>]: df2 = pd.DataFrame(&#123; <span class="string">'A'</span> : 1.,</div><div class="line">   ....:                      <span class="string">'B'</span> : <span class="type">pd.Timestamp</span>('<span class="number">20130102</span>'),</div><div class="line">   ....:                      <span class="string">'C'</span> : <span class="type">pd.Series</span>(<span class="number">1</span>,index=list(<span class="keyword">range</span>(<span class="number">4</span>)),dtype=<span class="symbol">'float32</span>'),</div><div class="line">   ....:                      <span class="string">'D'</span> : <span class="type">np.array</span>([<span class="number">3</span>] * <span class="number">4</span>,dtype=<span class="symbol">'int32</span>'),</div><div class="line">   ....:                      <span class="string">'E'</span> : <span class="type">pd.Categorical</span>([<span class="string">"test"</span>,<span class="string">"train"</span>,<span class="string">"test"</span>,<span class="string">"train"</span>]),</div><div class="line">   ....:                      <span class="string">'F'</span> : '<span class="type">foo</span>' &#125;)</div><div class="line">   ....: </div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">11</span>]: df2</div><div class="line"><span class="keyword">Out</span>[<span class="number">11</span>]: </div><div class="line">     A          B    C  D      E    F</div><div class="line"><span class="number">0</span>  <span class="number">1.0</span> <span class="number">2013</span>-<span class="number">01</span>-<span class="number">02</span>  <span class="number">1.0</span>  <span class="number">3</span>   test  foo</div><div class="line"><span class="number">1</span>  <span class="number">1.0</span> <span class="number">2013</span>-<span class="number">01</span>-<span class="number">02</span>  <span class="number">1.0</span>  <span class="number">3</span>  train  foo</div><div class="line"><span class="number">2</span>  <span class="number">1.0</span> <span class="number">2013</span>-<span class="number">01</span>-<span class="number">02</span>  <span class="number">1.0</span>  <span class="number">3</span>   test  foo</div><div class="line"><span class="number">3</span>  <span class="number">1.0</span> <span class="number">2013</span>-<span class="number">01</span>-<span class="number">02</span>  <span class="number">1.0</span>  <span class="number">3</span>  train  foo</div></pre></td></tr></table></figure><p>查看不同列的数据类型：</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">In</span> [<span class="number">12</span>]: df2.dtypes</div><div class="line"><span class="keyword">Out</span>[<span class="number">12</span>]: </div><div class="line">A           float64</div><div class="line">B    datetime64[ns]</div><div class="line"><span class="keyword">C</span>           float32</div><div class="line"><span class="keyword">D</span>             int32</div><div class="line"><span class="keyword">E</span>          category</div><div class="line">F            object</div><div class="line">dtype: object</div></pre></td></tr></table></figure><p>如果你正在使用IPython，使用Tab自动补全功能会自动识别所有的属性以及自定义的列，下图中是所有能够被自动识别的属性的一个子集：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">13</span>]: df2.&lt;TAB&gt;</div><div class="line">df2<span class="selector-class">.A</span>                  df2<span class="selector-class">.bool</span></div><div class="line">df2<span class="selector-class">.abs</span>                df2<span class="selector-class">.boxplot</span></div><div class="line">df2<span class="selector-class">.add</span>                df2<span class="selector-class">.C</span></div><div class="line">df2<span class="selector-class">.add_prefix</span>         df2<span class="selector-class">.clip</span></div><div class="line">df2<span class="selector-class">.add_suffix</span>         df2<span class="selector-class">.clip_lower</span></div><div class="line">df2<span class="selector-class">.align</span>              df2<span class="selector-class">.clip_upper</span></div><div class="line">df2<span class="selector-class">.all</span>                df2<span class="selector-class">.columns</span></div><div class="line">df2<span class="selector-class">.any</span>                df2<span class="selector-class">.combine</span></div><div class="line">df2<span class="selector-class">.append</span>             df2<span class="selector-class">.combine_first</span></div><div class="line">df2<span class="selector-class">.apply</span>              df2<span class="selector-class">.compound</span></div><div class="line">df2<span class="selector-class">.applymap</span>           df2<span class="selector-class">.consolidate</span></div><div class="line">df2.D</div></pre></td></tr></table></figure><p>正如你所看的，这里的列<code>A</code>,<code>B</code>,<code>C</code>和<code>D</code>是自动补全的，为了简洁，其余的属性被截断。</p><h2 id="查看数据"><a href="#查看数据" class="headerlink" title="查看数据"></a>查看数据</h2><p>详情请参阅:<a href="http://pandas.pydata.org/pandas-docs/stable/basics.html#basics" target="_blank" rel="external">Basics section</a></p><p>查看frame中头部和尾部的行：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">14</span>]: df.head()</div><div class="line">Out[<span class="number">14</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C         D</div><div class="line"><span class="number">2013-01-01</span>  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span></div><div class="line"><span class="number">2013-01-02</span>  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></div><div class="line"><span class="number">2013-01-03</span> -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span></div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></div><div class="line"><span class="number">2013-01-05</span> -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span></div><div class="line"></div><div class="line">In [<span class="number">15</span>]: df.tail(<span class="number">3</span>)</div><div class="line">Out[<span class="number">15</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C         D</div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></div><div class="line"><span class="number">2013-01-05</span> -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span></div><div class="line"><span class="number">2013-01-06</span> -<span class="number">0.673690</span>  <span class="number">0.113648</span> -<span class="number">1.478427</span>  <span class="number">0.524988</span></div></pre></td></tr></table></figure><p>显示索引，列和底层numpy数据:</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">In</span> [<span class="number">16</span>]: df.index</div><div class="line"><span class="symbol">Out</span>[<span class="number">16</span>]: </div><div class="line"><span class="symbol">DatetimeIndex</span>([<span class="string">'2013-01-01'</span>, <span class="string">'2013-01-02'</span>, <span class="string">'2013-01-03'</span>, <span class="string">'2013-01-04'</span>,</div><div class="line">               <span class="string">'2013-01-05'</span>, <span class="string">'2013-01-06'</span>],</div><div class="line">              dtype=<span class="string">'datetime64[ns]'</span>, freq=<span class="string">'D'</span>)</div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">17</span>]: df.columns</div><div class="line"><span class="symbol">Out</span>[<span class="number">17</span>]: <span class="symbol">Index</span>([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>], dtype=<span class="string">'object'</span>)</div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">18</span>]: df.values</div><div class="line"><span class="symbol">Out</span>[<span class="number">18</span>]: </div><div class="line">array([[ <span class="number">0.4691</span>, <span class="number">-0.2829</span>, <span class="number">-1.5091</span>, <span class="number">-1.1356</span>],</div><div class="line">       [ <span class="number">1.2121</span>, <span class="number">-0.1732</span>,  <span class="number">0.1192</span>, <span class="number">-1.0442</span>],</div><div class="line">       [<span class="number">-0.8618</span>, <span class="number">-2.1046</span>, <span class="number">-0.4949</span>,  <span class="number">1.0718</span>],</div><div class="line">       [ <span class="number">0.7216</span>, <span class="number">-0.7068</span>, <span class="number">-1.0396</span>,  <span class="number">0.2719</span>],</div><div class="line">       [<span class="number">-0.425</span> ,  <span class="number">0.567</span> ,  <span class="number">0.2762</span>, <span class="number">-1.0874</span>],</div><div class="line">       [<span class="number">-0.6737</span>,  <span class="number">0.1136</span>, <span class="number">-1.4784</span>,  <span class="number">0.525</span> ]])</div></pre></td></tr></table></figure><p><code>describe()</code>函数对于数据的快速统计汇总：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[19]</span>: <span class="selector-tag">df</span><span class="selector-class">.describe</span>()</div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[19]</span>: </div><div class="line">              <span class="selector-tag">A</span>         <span class="selector-tag">B</span>         <span class="selector-tag">C</span>         <span class="selector-tag">D</span></div><div class="line"><span class="selector-tag">count</span>  6<span class="selector-class">.000000</span>  6<span class="selector-class">.000000</span>  6<span class="selector-class">.000000</span>  6<span class="selector-class">.000000</span></div><div class="line"><span class="selector-tag">mean</span>   0<span class="selector-class">.073711</span> <span class="selector-tag">-0</span><span class="selector-class">.431125</span> <span class="selector-tag">-0</span><span class="selector-class">.687758</span> <span class="selector-tag">-0</span><span class="selector-class">.233103</span></div><div class="line"><span class="selector-tag">std</span>    0<span class="selector-class">.843157</span>  0<span class="selector-class">.922818</span>  0<span class="selector-class">.779887</span>  0<span class="selector-class">.973118</span></div><div class="line"><span class="selector-tag">min</span>   <span class="selector-tag">-0</span><span class="selector-class">.861849</span> <span class="selector-tag">-2</span><span class="selector-class">.104569</span> <span class="selector-tag">-1</span><span class="selector-class">.509059</span> <span class="selector-tag">-1</span><span class="selector-class">.135632</span></div><div class="line">25%   <span class="selector-tag">-0</span><span class="selector-class">.611510</span> <span class="selector-tag">-0</span><span class="selector-class">.600794</span> <span class="selector-tag">-1</span><span class="selector-class">.368714</span> <span class="selector-tag">-1</span><span class="selector-class">.076610</span></div><div class="line">50%    0<span class="selector-class">.022070</span> <span class="selector-tag">-0</span><span class="selector-class">.228039</span> <span class="selector-tag">-0</span><span class="selector-class">.767252</span> <span class="selector-tag">-0</span><span class="selector-class">.386188</span></div><div class="line">75%    0<span class="selector-class">.658444</span>  0<span class="selector-class">.041933</span> <span class="selector-tag">-0</span><span class="selector-class">.034326</span>  0<span class="selector-class">.461706</span></div><div class="line"><span class="selector-tag">max</span>    1<span class="selector-class">.212112</span>  0<span class="selector-class">.567020</span>  0<span class="selector-class">.276232</span>  1<span class="selector-class">.071804</span></div></pre></td></tr></table></figure><p>对数据的转置：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">20</span>]: df.T</div><div class="line">Out[<span class="number">20</span>]: </div><div class="line">   <span class="number">2013-01-01</span>  <span class="number">2013-01-02</span>  <span class="number">2013-01-03</span>  <span class="number">2013-01-04</span>  <span class="number">2013-01-05</span>  <span class="number">2013-01-06</span></div><div class="line"><span class="keyword">A</span>    <span class="number">0.469112</span>    <span class="number">1.212112</span>   -<span class="number">0.861849</span>    <span class="number">0.721555</span>   -<span class="number">0.424972</span>   -<span class="number">0.673690</span></div><div class="line">B   -<span class="number">0.282863</span>   -<span class="number">0.173215</span>   -<span class="number">2.104569</span>   -<span class="number">0.706771</span>    <span class="number">0.567020</span>    <span class="number">0.113648</span></div><div class="line">C   -<span class="number">1.509059</span>    <span class="number">0.119209</span>   -<span class="number">0.494929</span>   -<span class="number">1.039575</span>    <span class="number">0.276232</span>   -<span class="number">1.478427</span></div><div class="line">D   -<span class="number">1.135632</span>   -<span class="number">1.044236</span>    <span class="number">1.071804</span>    <span class="number">0.271860</span>   -<span class="number">1.087401</span>    <span class="number">0.524988</span></div></pre></td></tr></table></figure><p>按轴进行排序</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">21</span>]: df.sort_index(axis=<span class="number">1</span>, ascending=False)</div><div class="line">Out[<span class="number">21</span>]: </div><div class="line">                   D         C         B         <span class="keyword">A</span></div><div class="line"><span class="number">2013-01-01</span> -<span class="number">1.135632</span> -<span class="number">1.509059</span> -<span class="number">0.282863</span>  <span class="number">0.469112</span></div><div class="line"><span class="number">2013-01-02</span> -<span class="number">1.044236</span>  <span class="number">0.119209</span> -<span class="number">0.173215</span>  <span class="number">1.212112</span></div><div class="line"><span class="number">2013-01-03</span>  <span class="number">1.071804</span> -<span class="number">0.494929</span> -<span class="number">2.104569</span> -<span class="number">0.861849</span></div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.271860</span> -<span class="number">1.039575</span> -<span class="number">0.706771</span>  <span class="number">0.721555</span></div><div class="line"><span class="number">2013-01-05</span> -<span class="number">1.087401</span>  <span class="number">0.276232</span>  <span class="number">0.567020</span> -<span class="number">0.424972</span></div><div class="line"><span class="number">2013-01-06</span>  <span class="number">0.524988</span> -<span class="number">1.478427</span>  <span class="number">0.113648</span> -<span class="number">0.673690</span></div></pre></td></tr></table></figure><p>按值进行排序</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">22</span>]: df.sort_values(by='B')</div><div class="line">Out[<span class="number">22</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C         D</div><div class="line"><span class="number">2013-01-03</span> -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span></div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></div><div class="line"><span class="number">2013-01-01</span>  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span></div><div class="line"><span class="number">2013-01-02</span>  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></div><div class="line"><span class="number">2013-01-06</span> -<span class="number">0.673690</span>  <span class="number">0.113648</span> -<span class="number">1.478427</span>  <span class="number">0.524988</span></div><div class="line"><span class="number">2013-01-05</span> -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span></div></pre></td></tr></table></figure><h2 id="选择"><a href="#选择" class="headerlink" title="选择"></a>选择</h2><blockquote><p><strong>注意：</strong>虽然用于选择和设置的标准的Python/Numpy表达式非常直观，可用于交互式工作，但对于生产代码，我们推荐优化的pandas数据访问方法<code>.at</code>，<code>.iat</code>，<code>.loc</code>，<code>.iloc</code>和<code>.ix</code>。</p></blockquote><p>详情请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing" target="_blank" rel="external">Indexing and Selecing Data</a>和 <a href="http://pandas.pydata.org/pandas-docs/stable/advanced.html#advanced" target="_blank" rel="external">MultiIndex / Advanced Indexing</a>。</p><h3 id="获取"><a href="#获取" class="headerlink" title="获取"></a>获取</h3><p>选择一个单独的列，这将会返回一个<code>Series</code>，等同于<code>df.A</code>：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">23</span>]: df['<span class="keyword">A</span>']</div><div class="line">Out[<span class="number">23</span>]: </div><div class="line"><span class="number">2013-01-01</span>    <span class="number">0.469112</span></div><div class="line"><span class="number">2013-01-02</span>    <span class="number">1.212112</span></div><div class="line"><span class="number">2013-01-03</span>   -<span class="number">0.861849</span></div><div class="line"><span class="number">2013-01-04</span>    <span class="number">0.721555</span></div><div class="line"><span class="number">2013-01-05</span>   -<span class="number">0.424972</span></div><div class="line"><span class="number">2013-01-06</span>   -<span class="number">0.673690</span></div><div class="line">Freq: D, Name: <span class="keyword">A</span>, dtype: float64</div></pre></td></tr></table></figure><p>通过<code>[]</code>进行选择，这将会对行进行切片:</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">24</span>]: df[<span class="number">0</span>:<span class="number">3</span>]</div><div class="line">Out[<span class="number">24</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C         D</div><div class="line"><span class="number">2013-01-01</span>  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span></div><div class="line"><span class="number">2013-01-02</span>  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></div><div class="line"><span class="number">2013-01-03</span> -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span></div><div class="line"></div><div class="line">In [<span class="number">25</span>]: df['<span class="number">20130102</span>':'<span class="number">20130104</span>']</div><div class="line">Out[<span class="number">25</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C         D</div><div class="line"><span class="number">2013-01-02</span>  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></div><div class="line"><span class="number">2013-01-03</span> -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span></div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></div></pre></td></tr></table></figure><h3 id="通过标签选择"><a href="#通过标签选择" class="headerlink" title="通过标签选择"></a>通过标签选择</h3><p>详情请参加<a href="http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-label" target="_blank" rel="external">Selection by Label</a></p><p>使用标签获取横截面</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[26]</span>: <span class="selector-tag">df</span><span class="selector-class">.loc</span><span class="selector-attr">[dates[0]</span>]</div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[26]</span>: </div><div class="line"><span class="selector-tag">A</span>    0<span class="selector-class">.469112</span></div><div class="line"><span class="selector-tag">B</span>   <span class="selector-tag">-0</span><span class="selector-class">.282863</span></div><div class="line"><span class="selector-tag">C</span>   <span class="selector-tag">-1</span><span class="selector-class">.509059</span></div><div class="line"><span class="selector-tag">D</span>   <span class="selector-tag">-1</span><span class="selector-class">.135632</span></div><div class="line"><span class="selector-tag">Name</span>: 2013<span class="selector-tag">-01-01</span> 00<span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span>, <span class="selector-tag">dtype</span>: <span class="selector-tag">float64</span></div></pre></td></tr></table></figure><p>通过标签选择多轴</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">27</span>]: df.loc[:,['<span class="keyword">A</span>','B']]</div><div class="line">Out[<span class="number">27</span>]: </div><div class="line">                   <span class="keyword">A</span>         B</div><div class="line"><span class="number">2013-01-01</span>  <span class="number">0.469112</span> -<span class="number">0.282863</span></div><div class="line"><span class="number">2013-01-02</span>  <span class="number">1.212112</span> -<span class="number">0.173215</span></div><div class="line"><span class="number">2013-01-03</span> -<span class="number">0.861849</span> -<span class="number">2.104569</span></div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.721555</span> -<span class="number">0.706771</span></div><div class="line"><span class="number">2013-01-05</span> -<span class="number">0.424972</span>  <span class="number">0.567020</span></div><div class="line"><span class="number">2013-01-06</span> -<span class="number">0.673690</span>  <span class="number">0.113648</span></div></pre></td></tr></table></figure><p>显示包括两个端点的标签切片：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">28</span>]: df.loc['<span class="number">20130102</span>':'<span class="number">20130104</span>',['<span class="keyword">A</span>','B']]</div><div class="line">Out[<span class="number">28</span>]: </div><div class="line">                   <span class="keyword">A</span>         B</div><div class="line"><span class="number">2013-01-02</span>  <span class="number">1.212112</span> -<span class="number">0.173215</span></div><div class="line"><span class="number">2013-01-03</span> -<span class="number">0.861849</span> -<span class="number">2.104569</span></div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.721555</span> -<span class="number">0.706771</span></div></pre></td></tr></table></figure><p>减少返回的对象的尺寸:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[29]</span>: <span class="selector-tag">df</span><span class="selector-class">.loc</span><span class="selector-attr">['20130102',['A','B']</span>]</div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[29]</span>: </div><div class="line"><span class="selector-tag">A</span>    1<span class="selector-class">.212112</span></div><div class="line"><span class="selector-tag">B</span>   <span class="selector-tag">-0</span><span class="selector-class">.173215</span></div><div class="line"><span class="selector-tag">Name</span>: 2013<span class="selector-tag">-01-02</span> 00<span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span>, <span class="selector-tag">dtype</span>: <span class="selector-tag">float64</span></div></pre></td></tr></table></figure><p>获得标量值</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">In</span> [<span class="number">30</span>]: df.loc[dates[<span class="number">0</span>],<span class="string">'A'</span>]</div><div class="line"><span class="symbol">Out</span>[<span class="number">30</span>]: <span class="number">0.46911229990718628</span></div></pre></td></tr></table></figure><p>快速访问一个标量（与上一个方法等价）</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">In</span> [<span class="number">31</span>]: df.at[dates[<span class="number">0</span>],<span class="string">'A'</span>]</div><div class="line"><span class="symbol">Out</span>[<span class="number">31</span>]: <span class="number">0.46911229990718628</span></div></pre></td></tr></table></figure><h3 id="按位置选择"><a href="#按位置选择" class="headerlink" title="按位置选择"></a>按位置选择</h3><p>详情请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-integer" target="_blank" rel="external">Selection by Position</a></p><p>通过传入的整数位置来选择：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[32]</span>: <span class="selector-tag">df</span><span class="selector-class">.iloc</span><span class="selector-attr">[3]</span></div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[32]</span>: </div><div class="line"><span class="selector-tag">A</span>    0<span class="selector-class">.721555</span></div><div class="line"><span class="selector-tag">B</span>   <span class="selector-tag">-0</span><span class="selector-class">.706771</span></div><div class="line"><span class="selector-tag">C</span>   <span class="selector-tag">-1</span><span class="selector-class">.039575</span></div><div class="line"><span class="selector-tag">D</span>    0<span class="selector-class">.271860</span></div><div class="line"><span class="selector-tag">Name</span>: 2013<span class="selector-tag">-01-04</span> 00<span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span>, <span class="selector-tag">dtype</span>: <span class="selector-tag">float64</span></div></pre></td></tr></table></figure><p>可以做类似numpy/python的整数切片操作</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[33]</span>: <span class="selector-tag">df</span><span class="selector-class">.iloc</span><span class="selector-attr">[3:5,0:2]</span></div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[33]</span>: </div><div class="line">                   <span class="selector-tag">A</span>         <span class="selector-tag">B</span></div><div class="line">2013<span class="selector-tag">-01-04</span>  0<span class="selector-class">.721555</span> <span class="selector-tag">-0</span><span class="selector-class">.706771</span></div><div class="line">2013<span class="selector-tag">-01-05</span> <span class="selector-tag">-0</span><span class="selector-class">.424972</span>  0<span class="selector-class">.567020</span></div></pre></td></tr></table></figure><p>可以做类似于numpy/python风格的列出指定索引位置的行列列表的操作</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[34]</span>: <span class="selector-tag">df</span><span class="selector-class">.iloc</span><span class="selector-attr">[[1,2,4]</span>,<span class="selector-attr">[0,2]</span>]</div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[34]</span>: </div><div class="line">                   <span class="selector-tag">A</span>         <span class="selector-tag">C</span></div><div class="line">2013<span class="selector-tag">-01-02</span>  1<span class="selector-class">.212112</span>  0<span class="selector-class">.119209</span></div><div class="line">2013<span class="selector-tag">-01-03</span> <span class="selector-tag">-0</span><span class="selector-class">.861849</span> <span class="selector-tag">-0</span><span class="selector-class">.494929</span></div><div class="line">2013<span class="selector-tag">-01-05</span> <span class="selector-tag">-0</span><span class="selector-class">.424972</span>  0<span class="selector-class">.276232</span></div></pre></td></tr></table></figure><p>选择具体的行</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[35]</span>: <span class="selector-tag">df</span><span class="selector-class">.iloc</span><span class="selector-attr">[1:3,:]</span></div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[35]</span>: </div><div class="line">                   <span class="selector-tag">A</span>         <span class="selector-tag">B</span>         <span class="selector-tag">C</span>         <span class="selector-tag">D</span></div><div class="line">2013<span class="selector-tag">-01-02</span>  1<span class="selector-class">.212112</span> <span class="selector-tag">-0</span><span class="selector-class">.173215</span>  0<span class="selector-class">.119209</span> <span class="selector-tag">-1</span><span class="selector-class">.044236</span></div><div class="line">2013<span class="selector-tag">-01-03</span> <span class="selector-tag">-0</span><span class="selector-class">.861849</span> <span class="selector-tag">-2</span><span class="selector-class">.104569</span> <span class="selector-tag">-0</span><span class="selector-class">.494929</span>  1<span class="selector-class">.071804</span></div></pre></td></tr></table></figure><p>选择具体的列</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">36</span>]: df.iloc[:,<span class="number">1</span>:<span class="number">3</span>]</div><div class="line">Out[<span class="number">36</span>]: </div><div class="line">                   B         C</div><div class="line"><span class="number">2013-01-01</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span></div><div class="line"><span class="number">2013-01-02</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span></div><div class="line"><span class="number">2013-01-03</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span></div><div class="line"><span class="number">2013-01-04</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span></div><div class="line"><span class="number">2013-01-05</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span></div><div class="line"><span class="number">2013-01-06</span>  <span class="number">0.113648</span> -<span class="number">1.478427</span></div></pre></td></tr></table></figure><p>明确地获取一个值</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[37]</span>: <span class="selector-tag">df</span><span class="selector-class">.iloc</span><span class="selector-attr">[1,1]</span></div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[37]</span>: <span class="selector-tag">-0</span><span class="selector-class">.17321464905330858</span></div></pre></td></tr></table></figure><p>快速访问一个标量（等同于上面的方法）</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[38]</span>: <span class="selector-tag">df</span><span class="selector-class">.iat</span><span class="selector-attr">[1,1]</span></div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[38]</span>: <span class="selector-tag">-0</span><span class="selector-class">.17321464905330858</span></div></pre></td></tr></table></figure><h3 id="布尔索引操作"><a href="#布尔索引操作" class="headerlink" title="布尔索引操作"></a>布尔索引操作</h3><p>使用单一列的值来选取数据</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">39</span>]: df[df.<span class="keyword">A</span> &gt; <span class="number">0</span>]</div><div class="line">Out[<span class="number">39</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C         D</div><div class="line"><span class="number">2013-01-01</span>  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span></div><div class="line"><span class="number">2013-01-02</span>  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></div></pre></td></tr></table></figure><p>从DataFrame选取符合布尔判断条件的数据</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">40</span>]: df[df &gt; <span class="number">0</span>]</div><div class="line">Out[<span class="number">40</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C         D</div><div class="line"><span class="number">2013-01-01</span>  <span class="number">0.469112</span>       NaN       NaN       NaN</div><div class="line"><span class="number">2013-01-02</span>  <span class="number">1.212112</span>       NaN  <span class="number">0.119209</span>       NaN</div><div class="line"><span class="number">2013-01-03</span>       NaN       NaN       NaN  <span class="number">1.071804</span></div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.721555</span>       NaN       NaN  <span class="number">0.271860</span></div><div class="line"><span class="number">2013-01-05</span>       NaN  <span class="number">0.567020</span>  <span class="number">0.276232</span>       NaN</div><div class="line"><span class="number">2013-01-06</span>       NaN  <span class="number">0.113648</span>       NaN  <span class="number">0.524988</span></div></pre></td></tr></table></figure><p>使用<code>isin()</code>方法来过滤：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">41</span>]: df2 = df.copy()</div><div class="line"></div><div class="line">In [<span class="number">42</span>]: df2['E'] = ['one', 'one','two','three','four','three']</div><div class="line"></div><div class="line">In [<span class="number">43</span>]: df2</div><div class="line">Out[<span class="number">43</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C         D      E</div><div class="line"><span class="number">2013-01-01</span>  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span>    one</div><div class="line"><span class="number">2013-01-02</span>  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span>    one</div><div class="line"><span class="number">2013-01-03</span> -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span>    two</div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span>  three</div><div class="line"><span class="number">2013-01-05</span> -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span>   four</div><div class="line"><span class="number">2013-01-06</span> -<span class="number">0.673690</span>  <span class="number">0.113648</span> -<span class="number">1.478427</span>  <span class="number">0.524988</span>  three</div><div class="line"></div><div class="line">In [<span class="number">44</span>]: df2[df2['E'].isin(['two','four'])]</div><div class="line">Out[<span class="number">44</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C         D     E</div><div class="line"><span class="number">2013-01-03</span> -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span>   two</div><div class="line"><span class="number">2013-01-05</span> -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span>  four</div></pre></td></tr></table></figure><h3 id="设置数据"><a href="#设置数据" class="headerlink" title="设置数据"></a>设置数据</h3><p>设置新列，自动按索引排列数据</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">45</span>]: s1 = pd.Series([<span class="number">1,2,3,4</span>,<span class="number">5</span>,<span class="number">6</span>], index=pd.date_range('<span class="number">20130102</span>', periods=<span class="number">6</span>))</div><div class="line"></div><div class="line">In [<span class="number">46</span>]: s1</div><div class="line">Out[<span class="number">46</span>]: </div><div class="line"><span class="number">2013-01-02</span>    <span class="number">1</span></div><div class="line"><span class="number">2013-01-03</span>    <span class="number">2</span></div><div class="line"><span class="number">2013-01-04</span>    <span class="number">3</span></div><div class="line"><span class="number">2013-01-05</span>    <span class="number">4</span></div><div class="line"><span class="number">2013-01-06</span>    <span class="number">5</span></div><div class="line"><span class="number">2013-01-07</span>    <span class="number">6</span></div><div class="line">Freq: D, dtype: int64</div><div class="line"></div><div class="line">In [<span class="number">47</span>]: df['F'] = s1</div></pre></td></tr></table></figure><p>通过标签来设定数据</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">In</span> [<span class="number">48</span>]: df.at[dates[<span class="number">0</span>],<span class="string">'A'</span>] = <span class="number">0</span></div></pre></td></tr></table></figure><p>通过位置索引来设定数据</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">In <span class="string">[49]</span>: df.iat<span class="string">[0,1]</span> = <span class="number">0</span></div></pre></td></tr></table></figure><p>通过分配一个numpy数组来设定数据</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">In</span> [<span class="number">50</span>]: df.loc[:,<span class="string">'D'</span>] = np.array([<span class="number">5</span>] * len(df))</div></pre></td></tr></table></figure><p>之前操作的结果</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[51]</span>: <span class="selector-tag">df</span></div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[51]</span>: </div><div class="line">                   <span class="selector-tag">A</span>         <span class="selector-tag">B</span>         <span class="selector-tag">C</span>  <span class="selector-tag">D</span>    <span class="selector-tag">F</span></div><div class="line">2013<span class="selector-tag">-01-01</span>  0<span class="selector-class">.000000</span>  0<span class="selector-class">.000000</span> <span class="selector-tag">-1</span><span class="selector-class">.509059</span>  5  <span class="selector-tag">NaN</span></div><div class="line">2013<span class="selector-tag">-01-02</span>  1<span class="selector-class">.212112</span> <span class="selector-tag">-0</span><span class="selector-class">.173215</span>  0<span class="selector-class">.119209</span>  5  1<span class="selector-class">.0</span></div><div class="line">2013<span class="selector-tag">-01-03</span> <span class="selector-tag">-0</span><span class="selector-class">.861849</span> <span class="selector-tag">-2</span><span class="selector-class">.104569</span> <span class="selector-tag">-0</span><span class="selector-class">.494929</span>  5  2<span class="selector-class">.0</span></div><div class="line">2013<span class="selector-tag">-01-04</span>  0<span class="selector-class">.721555</span> <span class="selector-tag">-0</span><span class="selector-class">.706771</span> <span class="selector-tag">-1</span><span class="selector-class">.039575</span>  5  3<span class="selector-class">.0</span></div><div class="line">2013<span class="selector-tag">-01-05</span> <span class="selector-tag">-0</span><span class="selector-class">.424972</span>  0<span class="selector-class">.567020</span>  0<span class="selector-class">.276232</span>  5  4<span class="selector-class">.0</span></div><div class="line">2013<span class="selector-tag">-01-06</span> <span class="selector-tag">-0</span><span class="selector-class">.673690</span>  0<span class="selector-class">.113648</span> <span class="selector-tag">-1</span><span class="selector-class">.478427</span>  5  5<span class="selector-class">.0</span></div></pre></td></tr></table></figure><p>带有<code>where</code>操作的设值</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">52</span>]: df2 = df.copy()</div><div class="line"></div><div class="line">In [<span class="number">53</span>]: df2[df2 &gt; <span class="number">0</span>] = -df2</div><div class="line"></div><div class="line">In [<span class="number">54</span>]: df2</div><div class="line">Out[<span class="number">54</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C  D    F</div><div class="line"><span class="number">2013-01-01</span>  <span class="number">0.000000</span>  <span class="number">0.000000</span> -<span class="number">1.509059</span> -<span class="number">5</span>  NaN</div><div class="line"><span class="number">2013-01-02</span> -<span class="number">1.212112</span> -<span class="number">0.173215</span> -<span class="number">0.119209</span> -<span class="number">5</span> -<span class="number">1</span>.<span class="number">0</span></div><div class="line"><span class="number">2013-01-03</span> -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span> -<span class="number">5</span> -<span class="number">2</span>.<span class="number">0</span></div><div class="line"><span class="number">2013-01-04</span> -<span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span> -<span class="number">5</span> -<span class="number">3</span>.<span class="number">0</span></div><div class="line"><span class="number">2013-01-05</span> -<span class="number">0.424972</span> -<span class="number">0.567020</span> -<span class="number">0.276232</span> -<span class="number">5</span> -<span class="number">4</span>.<span class="number">0</span></div><div class="line"><span class="number">2013-01-06</span> -<span class="number">0.673690</span> -<span class="number">0.113648</span> -<span class="number">1.478427</span> -<span class="number">5</span> -<span class="number">5</span>.<span class="number">0</span></div></pre></td></tr></table></figure><h2 id="缺失值处理"><a href="#缺失值处理" class="headerlink" title="缺失值处理"></a>缺失值处理</h2><p>pandas主要使用<code>np.nan</code>来代表缺失数据。这些值将默认不会包含在计算中，详情请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/missing_data.html#missing-data" target="_blank" rel="external">Missing Data section</a></p><p>Reindexing允许您更改/添加/删除指定轴上的索引。这将返回数据的副本。</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">55</span>]: df1 = df.reindex(index=dates[<span class="number">0</span>:<span class="number">4</span>], columns=list(df.columns) + ['E'])</div><div class="line"></div><div class="line">In [<span class="number">56</span>]: df1.loc[dates[<span class="number">0</span>]:dates[<span class="number">1</span>],'E'] = <span class="number">1</span></div><div class="line"></div><div class="line">In [<span class="number">57</span>]: df1</div><div class="line">Out[<span class="number">57</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C  D    F    E</div><div class="line"><span class="number">2013-01-01</span>  <span class="number">0.000000</span>  <span class="number">0.000000</span> -<span class="number">1.509059</span>  <span class="number">5</span>  NaN  <span class="number">1</span>.<span class="number">0</span></div><div class="line"><span class="number">2013-01-02</span>  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span>  <span class="number">5</span>  <span class="number">1</span>.<span class="number">0</span>  <span class="number">1</span>.<span class="number">0</span></div><div class="line"><span class="number">2013-01-03</span> -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">5</span>  <span class="number">2</span>.<span class="number">0</span>  NaN</div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">5</span>  <span class="number">3</span>.<span class="number">0</span>  NaN</div></pre></td></tr></table></figure><p>删除所有具有缺失值的数据</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">In</span> [<span class="number">58</span>]: df1.dropna(how=<span class="string">'any'</span>)</div><div class="line"><span class="keyword">Out</span>[<span class="number">58</span>]: </div><div class="line">                   A         B         <span class="keyword">C</span>  <span class="keyword">D</span>    F    <span class="keyword">E</span></div><div class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">1.212112</span> <span class="number">-0.173215</span>  <span class="number">0.119209</span>  <span class="number">5</span>  <span class="number">1.0</span>  <span class="number">1.0</span></div></pre></td></tr></table></figure><p>填充缺失数据</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">59</span>]: df1.fillna(value=<span class="number">5</span>)</div><div class="line">Out[<span class="number">59</span>]: </div><div class="line">                   <span class="keyword">A</span>         B         C  D    F    E</div><div class="line"><span class="number">2013-01-01</span>  <span class="number">0.000000</span>  <span class="number">0.000000</span> -<span class="number">1.509059</span>  <span class="number">5</span>  <span class="number">5</span>.<span class="number">0</span>  <span class="number">1</span>.<span class="number">0</span></div><div class="line"><span class="number">2013-01-02</span>  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span>  <span class="number">5</span>  <span class="number">1</span>.<span class="number">0</span>  <span class="number">1</span>.<span class="number">0</span></div><div class="line"><span class="number">2013-01-03</span> -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">5</span>  <span class="number">2</span>.<span class="number">0</span>  <span class="number">5</span>.<span class="number">0</span></div><div class="line"><span class="number">2013-01-04</span>  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">5</span>  <span class="number">3</span>.<span class="number">0</span>  <span class="number">5</span>.<span class="number">0</span></div></pre></td></tr></table></figure><p>获取值为nan的布尔值掩码</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">In</span> [<span class="number">60</span>]: pd.isna(df1)</div><div class="line"><span class="keyword">Out</span>[<span class="number">60</span>]: </div><div class="line">                A      B      <span class="keyword">C</span>      <span class="keyword">D</span>      F      <span class="keyword">E</span></div><div class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>   <span class="keyword">True</span>  <span class="keyword">False</span></div><div class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span></div><div class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>   <span class="keyword">True</span></div><div class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>  <span class="keyword">False</span>   <span class="keyword">True</span></div></pre></td></tr></table></figure><h2 id="相关操作"><a href="#相关操作" class="headerlink" title="相关操作"></a>相关操作</h2><p>详情请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/basics.html#basics-binop" target="_blank" rel="external">Basic section on Binary Ops</a></p><h3 id="统计"><a href="#统计" class="headerlink" title="统计"></a>统计</h3><p>一般操作不包括丢失的数据。</p><p>执行描述性统计操作(沿数值方向求均值)</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[61]</span>: <span class="selector-tag">df</span><span class="selector-class">.mean</span>()</div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[61]</span>: </div><div class="line"><span class="selector-tag">A</span>   <span class="selector-tag">-0</span><span class="selector-class">.004474</span></div><div class="line"><span class="selector-tag">B</span>   <span class="selector-tag">-0</span><span class="selector-class">.383981</span></div><div class="line"><span class="selector-tag">C</span>   <span class="selector-tag">-0</span><span class="selector-class">.687758</span></div><div class="line"><span class="selector-tag">D</span>    5<span class="selector-class">.000000</span></div><div class="line"><span class="selector-tag">F</span>    3<span class="selector-class">.000000</span></div><div class="line"><span class="selector-tag">dtype</span>: <span class="selector-tag">float64</span></div></pre></td></tr></table></figure><p>在另一个轴上做相同的操作(沿水平方向求均值)</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">62</span>]: df.mean(<span class="number">1</span>)</div><div class="line">Out[<span class="number">62</span>]: </div><div class="line"><span class="number">2013-01-01</span>    <span class="number">0.872735</span></div><div class="line"><span class="number">2013-01-02</span>    <span class="number">1.431621</span></div><div class="line"><span class="number">2013-01-03</span>    <span class="number">0.707731</span></div><div class="line"><span class="number">2013-01-04</span>    <span class="number">1.395042</span></div><div class="line"><span class="number">2013-01-05</span>    <span class="number">1.883656</span></div><div class="line"><span class="number">2013-01-06</span>    <span class="number">1.592306</span></div><div class="line">Freq: D, dtype: float64</div></pre></td></tr></table></figure><p>使用具有不同维度且需要对齐的对象进行操作。另外，pandas会沿指定的尺寸自动广播。</p><blockquote><p>注意：1-np.nan 输出结果为NaN</p></blockquote><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">In</span> [<span class="number">63</span>]: s = pd.Series([<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,np.nan,<span class="number">6</span>,<span class="number">8</span>], index=dates).shift(<span class="number">2</span>)</div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">64</span>]: s</div><div class="line"><span class="keyword">Out</span>[<span class="number">64</span>]: </div><div class="line"><span class="number">2013</span>-<span class="number">01</span>-<span class="number">01</span>    <span class="meta">NaN</span></div><div class="line"><span class="number">2013</span>-<span class="number">01</span>-<span class="number">02</span>    <span class="meta">NaN</span></div><div class="line"><span class="number">2013</span>-<span class="number">01</span>-<span class="number">03</span>    <span class="number">1.0</span></div><div class="line"><span class="number">2013</span>-<span class="number">01</span>-<span class="number">04</span>    <span class="number">3.0</span></div><div class="line"><span class="number">2013</span>-<span class="number">01</span>-<span class="number">05</span>    <span class="number">5.0</span></div><div class="line"><span class="number">2013</span>-<span class="number">01</span>-<span class="number">06</span>    <span class="meta">NaN</span></div><div class="line"><span class="symbol">Freq:</span> D, dtype: <span class="meta">float64</span></div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">65</span>]: df.sub(s, axis=<span class="string">'index'</span>)</div><div class="line"><span class="keyword">Out</span>[<span class="number">65</span>]: </div><div class="line">                   A         B         C    D    F</div><div class="line"><span class="number">2013</span>-<span class="number">01</span>-<span class="number">01</span>       <span class="meta">NaN</span>       <span class="meta">NaN</span>       <span class="meta">NaN</span>  <span class="meta">NaN</span>  <span class="meta">NaN</span></div><div class="line"><span class="number">2013</span>-<span class="number">01</span>-<span class="number">02</span>       <span class="meta">NaN</span>       <span class="meta">NaN</span>       <span class="meta">NaN</span>  <span class="meta">NaN</span>  <span class="meta">NaN</span></div><div class="line"><span class="number">2013</span>-<span class="number">01</span>-<span class="number">03</span> -<span class="number">1.861849</span> -<span class="number">3.104569</span> -<span class="number">1.494929</span>  <span class="number">4.0</span>  <span class="number">1.0</span></div><div class="line"><span class="number">2013</span>-<span class="number">01</span>-<span class="number">04</span> -<span class="number">2.278445</span> -<span class="number">3.706771</span> -<span class="number">4.039575</span>  <span class="number">2.0</span>  <span class="number">0.0</span></div><div class="line"><span class="number">2013</span>-<span class="number">01</span>-<span class="number">05</span> -<span class="number">5.424972</span> -<span class="number">4.432980</span> -<span class="number">4.723768</span>  <span class="number">0.0</span> -<span class="number">1.0</span></div><div class="line"><span class="number">2013</span>-<span class="number">01</span>-<span class="number">06</span>       <span class="meta">NaN</span>       <span class="meta">NaN</span>       <span class="meta">NaN</span>  <span class="meta">NaN</span>  <span class="meta">NaN</span></div></pre></td></tr></table></figure><h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>将函数应用于数据</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"># 累加操作</div><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[66]</span>: <span class="selector-tag">df</span><span class="selector-class">.apply</span>(<span class="selector-tag">np</span><span class="selector-class">.cumsum</span>)</div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[66]</span>: </div><div class="line">                   <span class="selector-tag">A</span>         <span class="selector-tag">B</span>         <span class="selector-tag">C</span>   <span class="selector-tag">D</span>     <span class="selector-tag">F</span></div><div class="line">2013<span class="selector-tag">-01-01</span>  0<span class="selector-class">.000000</span>  0<span class="selector-class">.000000</span> <span class="selector-tag">-1</span><span class="selector-class">.509059</span>   5   <span class="selector-tag">NaN</span></div><div class="line">2013<span class="selector-tag">-01-02</span>  1<span class="selector-class">.212112</span> <span class="selector-tag">-0</span><span class="selector-class">.173215</span> <span class="selector-tag">-1</span><span class="selector-class">.389850</span>  10   1<span class="selector-class">.0</span></div><div class="line">2013<span class="selector-tag">-01-03</span>  0<span class="selector-class">.350263</span> <span class="selector-tag">-2</span><span class="selector-class">.277784</span> <span class="selector-tag">-1</span><span class="selector-class">.884779</span>  15   3<span class="selector-class">.0</span></div><div class="line">2013<span class="selector-tag">-01-04</span>  1<span class="selector-class">.071818</span> <span class="selector-tag">-2</span><span class="selector-class">.984555</span> <span class="selector-tag">-2</span><span class="selector-class">.924354</span>  20   6<span class="selector-class">.0</span></div><div class="line">2013<span class="selector-tag">-01-05</span>  0<span class="selector-class">.646846</span> <span class="selector-tag">-2</span><span class="selector-class">.417535</span> <span class="selector-tag">-2</span><span class="selector-class">.648122</span>  25  10<span class="selector-class">.0</span></div><div class="line">2013<span class="selector-tag">-01-06</span> <span class="selector-tag">-0</span><span class="selector-class">.026844</span> <span class="selector-tag">-2</span><span class="selector-class">.303886</span> <span class="selector-tag">-4</span><span class="selector-class">.126549</span>  30  15<span class="selector-class">.0</span></div><div class="line"></div><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[67]</span>: <span class="selector-tag">df</span><span class="selector-class">.apply</span>(<span class="selector-tag">lambda</span> <span class="selector-tag">x</span>: <span class="selector-tag">x</span><span class="selector-class">.max</span>() <span class="selector-tag">-</span> <span class="selector-tag">x</span><span class="selector-class">.min</span>())</div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[67]</span>: </div><div class="line"><span class="selector-tag">A</span>    2<span class="selector-class">.073961</span></div><div class="line"><span class="selector-tag">B</span>    2<span class="selector-class">.671590</span></div><div class="line"><span class="selector-tag">C</span>    1<span class="selector-class">.785291</span></div><div class="line"><span class="selector-tag">D</span>    0<span class="selector-class">.000000</span></div><div class="line"><span class="selector-tag">F</span>    4<span class="selector-class">.000000</span></div><div class="line"><span class="selector-tag">dtype</span>: <span class="selector-tag">float64</span></div></pre></td></tr></table></figure><h3 id="直方图"><a href="#直方图" class="headerlink" title="直方图"></a>直方图</h3><p>详情请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/basics.html#basics-discretization" target="_blank" rel="external">Histogramming and Discretization</a></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">In</span> [<span class="number">68</span>]: s = pd.Series(np.random.randint(<span class="number">0</span>, <span class="number">7</span>, size=<span class="number">10</span>))</div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">69</span>]: s</div><div class="line"><span class="keyword">Out</span>[<span class="number">69</span>]: </div><div class="line"><span class="number">0</span>    <span class="number">4</span></div><div class="line"><span class="number">1</span>    <span class="number">2</span></div><div class="line"><span class="number">2</span>    <span class="number">1</span></div><div class="line"><span class="number">3</span>    <span class="number">2</span></div><div class="line"><span class="number">4</span>    <span class="number">6</span></div><div class="line"><span class="number">5</span>    <span class="number">4</span></div><div class="line"><span class="number">6</span>    <span class="number">4</span></div><div class="line"><span class="number">7</span>    <span class="number">6</span></div><div class="line"><span class="number">8</span>    <span class="number">4</span></div><div class="line"><span class="number">9</span>    <span class="number">4</span></div><div class="line"><span class="symbol">dtype:</span> int64</div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">70</span>]: s.value_counts()</div><div class="line"><span class="keyword">Out</span>[<span class="number">70</span>]: </div><div class="line"><span class="number">4</span>    <span class="number">5</span></div><div class="line"><span class="number">6</span>    <span class="number">2</span></div><div class="line"><span class="number">2</span>    <span class="number">2</span></div><div class="line"><span class="number">1</span>    <span class="number">1</span></div><div class="line"><span class="symbol">dtype:</span> int64</div></pre></td></tr></table></figure><h3 id="字符串方法"><a href="#字符串方法" class="headerlink" title="字符串方法"></a>字符串方法</h3><p>Series对象在其str属性中配备了一组字符串处理方法，可以很容易的应用到数组中的每个元素，如下段代码所示。更多详情请参考：<a href="http://pandas.pydata.org/pandas-docs/stable/text.html#text-string-methods" target="_blank" rel="external">Vectorized String Methods</a></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">71</span>]: s = pd.Series([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'Aaba'</span>, <span class="string">'Baca'</span>, np<span class="selector-class">.nan</span>, <span class="string">'CABA'</span>, <span class="string">'dog'</span>, <span class="string">'cat'</span>])</div><div class="line"></div><div class="line">In [<span class="number">72</span>]: s<span class="selector-class">.str</span><span class="selector-class">.lower</span>()</div><div class="line">Out[<span class="number">72</span>]: </div><div class="line"><span class="number">0</span>       <span class="selector-tag">a</span></div><div class="line"><span class="number">1</span>       <span class="selector-tag">b</span></div><div class="line"><span class="number">2</span>       c</div><div class="line"><span class="number">3</span>    aaba</div><div class="line"><span class="number">4</span>    baca</div><div class="line"><span class="number">5</span>     NaN</div><div class="line"><span class="number">6</span>    caba</div><div class="line"><span class="number">7</span>     dog</div><div class="line"><span class="number">8</span>     cat</div><div class="line">dtype: object</div></pre></td></tr></table></figure><h2 id="合并"><a href="#合并" class="headerlink" title="合并"></a>合并</h2><h3 id="Concat"><a href="#Concat" class="headerlink" title="Concat"></a>Concat</h3><p>Pandas提供了大量的方法能够轻松的对Series，DataFrame和Panel对象进行各种符合各种逻辑关系的合并操作。</p><p>具体请参阅：<a href="http://pandas.pydata.org/pandas-docs/stable/merging.html#merging" target="_blank" rel="external">Merging section</a></p><p>通过使用<code>concat()</code>来将pandas对象链接起来：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">73</span>]: df = pd.DataFrame(np.random.randn(<span class="number">10</span>, <span class="number">4</span>))</div><div class="line"></div><div class="line">In [<span class="number">74</span>]: df</div><div class="line">Out[<span class="number">74</span>]: </div><div class="line">          <span class="number">0</span>         <span class="number">1</span>         <span class="number">2</span>         <span class="number">3</span></div><div class="line"><span class="number">0</span> -<span class="number">0.548702</span>  <span class="number">1.467327</span> -<span class="number">1.015962</span> -<span class="number">0.483075</span></div><div class="line"><span class="number">1</span>  <span class="number">1.637550</span> -<span class="number">1.217659</span> -<span class="number">0.291519</span> -<span class="number">1.745505</span></div><div class="line"><span class="number">2</span> -<span class="number">0.263952</span>  <span class="number">0.991460</span> -<span class="number">0.919069</span>  <span class="number">0.266046</span></div><div class="line"><span class="number">3</span> -<span class="number">0.709661</span>  <span class="number">1.669052</span>  <span class="number">1.037882</span> -<span class="number">1.705775</span></div><div class="line"><span class="number">4</span> -<span class="number">0.919854</span> -<span class="number">0.042379</span>  <span class="number">1.247642</span> -<span class="number">0.009920</span></div><div class="line"><span class="number">5</span>  <span class="number">0.290213</span>  <span class="number">0.495767</span>  <span class="number">0.362949</span>  <span class="number">1.548106</span></div><div class="line"><span class="number">6</span> -<span class="number">1.131345</span> -<span class="number">0.089329</span>  <span class="number">0.337863</span> -<span class="number">0.945867</span></div><div class="line"><span class="number">7</span> -<span class="number">0.932132</span>  <span class="number">1.956030</span>  <span class="number">0.017587</span> -<span class="number">0.016692</span></div><div class="line"><span class="number">8</span> -<span class="number">0.575247</span>  <span class="number">0.254161</span> -<span class="number">1.143704</span>  <span class="number">0.215897</span></div><div class="line"><span class="number">9</span>  <span class="number">1.193555</span> -<span class="number">0.077118</span> -<span class="number">0.408530</span> -<span class="number">0.862495</span></div><div class="line"></div><div class="line"># break it into pieces</div><div class="line">In [<span class="number">75</span>]: pieces = [df[:<span class="number">3</span>], df[<span class="number">3</span>:<span class="number">7</span>], df[<span class="number">7</span>:]]</div><div class="line"></div><div class="line">In [<span class="number">76</span>]: pd.concat(pieces)</div><div class="line">Out[<span class="number">76</span>]: </div><div class="line">          <span class="number">0</span>         <span class="number">1</span>         <span class="number">2</span>         <span class="number">3</span></div><div class="line"><span class="number">0</span> -<span class="number">0.548702</span>  <span class="number">1.467327</span> -<span class="number">1.015962</span> -<span class="number">0.483075</span></div><div class="line"><span class="number">1</span>  <span class="number">1.637550</span> -<span class="number">1.217659</span> -<span class="number">0.291519</span> -<span class="number">1.745505</span></div><div class="line"><span class="number">2</span> -<span class="number">0.263952</span>  <span class="number">0.991460</span> -<span class="number">0.919069</span>  <span class="number">0.266046</span></div><div class="line"><span class="number">3</span> -<span class="number">0.709661</span>  <span class="number">1.669052</span>  <span class="number">1.037882</span> -<span class="number">1.705775</span></div><div class="line"><span class="number">4</span> -<span class="number">0.919854</span> -<span class="number">0.042379</span>  <span class="number">1.247642</span> -<span class="number">0.009920</span></div><div class="line"><span class="number">5</span>  <span class="number">0.290213</span>  <span class="number">0.495767</span>  <span class="number">0.362949</span>  <span class="number">1.548106</span></div><div class="line"><span class="number">6</span> -<span class="number">1.131345</span> -<span class="number">0.089329</span>  <span class="number">0.337863</span> -<span class="number">0.945867</span></div><div class="line"><span class="number">7</span> -<span class="number">0.932132</span>  <span class="number">1.956030</span>  <span class="number">0.017587</span> -<span class="number">0.016692</span></div><div class="line"><span class="number">8</span> -<span class="number">0.575247</span>  <span class="number">0.254161</span> -<span class="number">1.143704</span>  <span class="number">0.215897</span></div><div class="line"><span class="number">9</span>  <span class="number">1.193555</span> -<span class="number">0.077118</span> -<span class="number">0.408530</span> -<span class="number">0.862495</span></div></pre></td></tr></table></figure><h3 id="Join"><a href="#Join" class="headerlink" title="Join"></a>Join</h3><p>类似于SQL类型的合并</p><p>具体请参阅：<a href="http://pandas.pydata.org/pandas-docs/stable/merging.html#merging-join" target="_blank" rel="external">Database style joining</a></p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">In</span> [<span class="number">77</span>]: left = pd.<span class="symbol">DataFrame</span>(&#123;<span class="string">'key'</span>: [<span class="string">'foo'</span>, <span class="string">'foo'</span>], <span class="string">'lval'</span>: [<span class="number">1</span>, <span class="number">2</span>]&#125;)</div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">78</span>]: right = pd.<span class="symbol">DataFrame</span>(&#123;<span class="string">'key'</span>: [<span class="string">'foo'</span>, <span class="string">'foo'</span>], <span class="string">'rval'</span>: [<span class="number">4</span>, <span class="number">5</span>]&#125;)</div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">79</span>]: left</div><div class="line"><span class="symbol">Out</span>[<span class="number">79</span>]: </div><div class="line">   key  lval</div><div class="line"><span class="number">0</span>  foo     <span class="number">1</span></div><div class="line"><span class="number">1</span>  foo     <span class="number">2</span></div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">80</span>]: right</div><div class="line"><span class="symbol">Out</span>[<span class="number">80</span>]: </div><div class="line">   key  rval</div><div class="line"><span class="number">0</span>  foo     <span class="number">4</span></div><div class="line"><span class="number">1</span>  foo     <span class="number">5</span></div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">81</span>]: pd.merge(left, right, on=<span class="string">'key'</span>)</div><div class="line"><span class="symbol">Out</span>[<span class="number">81</span>]: </div><div class="line">   key  lval  rval</div><div class="line"><span class="number">0</span>  foo     <span class="number">1</span>     <span class="number">4</span></div><div class="line"><span class="number">1</span>  foo     <span class="number">1</span>     <span class="number">5</span></div><div class="line"><span class="number">2</span>  foo     <span class="number">2</span>     <span class="number">4</span></div><div class="line"><span class="number">3</span>  foo     <span class="number">2</span>     <span class="number">5</span></div></pre></td></tr></table></figure><p>另一个可以给出的例子是：</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">In</span> [<span class="number">82</span>]: left = pd.<span class="symbol">DataFrame</span>(&#123;<span class="string">'key'</span>: [<span class="string">'foo'</span>, <span class="string">'bar'</span>], <span class="string">'lval'</span>: [<span class="number">1</span>, <span class="number">2</span>]&#125;)</div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">83</span>]: right = pd.<span class="symbol">DataFrame</span>(&#123;<span class="string">'key'</span>: [<span class="string">'foo'</span>, <span class="string">'bar'</span>], <span class="string">'rval'</span>: [<span class="number">4</span>, <span class="number">5</span>]&#125;)</div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">84</span>]: left</div><div class="line"><span class="symbol">Out</span>[<span class="number">84</span>]: </div><div class="line">   key  lval</div><div class="line"><span class="number">0</span>  foo     <span class="number">1</span></div><div class="line"><span class="number">1</span>  bar     <span class="number">2</span></div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">85</span>]: right</div><div class="line"><span class="symbol">Out</span>[<span class="number">85</span>]: </div><div class="line">   key  rval</div><div class="line"><span class="number">0</span>  foo     <span class="number">4</span></div><div class="line"><span class="number">1</span>  bar     <span class="number">5</span></div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">86</span>]: pd.merge(left, right, on=<span class="string">'key'</span>)</div><div class="line"><span class="symbol">Out</span>[<span class="number">86</span>]: </div><div class="line">   key  lval  rval</div><div class="line"><span class="number">0</span>  foo     <span class="number">1</span>     <span class="number">4</span></div><div class="line"><span class="number">1</span>  bar     <span class="number">2</span>     <span class="number">5</span></div></pre></td></tr></table></figure><h3 id="Append"><a href="#Append" class="headerlink" title="Append"></a>Append</h3><p>将一行连接到一个DataFrame上。</p><p>详情请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/merging.html#merging-concatenation" target="_blank" rel="external">Appending</a></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">87</span>]: df = pd.DataFrame(np.random.randn(<span class="number">8</span>, <span class="number">4</span>), columns=['<span class="keyword">A</span>','B','C','D'])</div><div class="line"></div><div class="line">In [<span class="number">88</span>]: df</div><div class="line">Out[<span class="number">88</span>]: </div><div class="line">          <span class="keyword">A</span>         B         C         D</div><div class="line"><span class="number">0</span>  <span class="number">1.346061</span>  <span class="number">1.511763</span>  <span class="number">1.627081</span> -<span class="number">0.990582</span></div><div class="line"><span class="number">1</span> -<span class="number">0.441652</span>  <span class="number">1.211526</span>  <span class="number">0.268520</span>  <span class="number">0.024580</span></div><div class="line"><span class="number">2</span> -<span class="number">1.577585</span>  <span class="number">0.396823</span> -<span class="number">0.105381</span> -<span class="number">0.532532</span></div><div class="line"><span class="number">3</span>  <span class="number">1.453749</span>  <span class="number">1.208843</span> -<span class="number">0.080952</span> -<span class="number">0.264610</span></div><div class="line"><span class="number">4</span> -<span class="number">0.727965</span> -<span class="number">0.589346</span>  <span class="number">0.339969</span> -<span class="number">0.693205</span></div><div class="line"><span class="number">5</span> -<span class="number">0.339355</span>  <span class="number">0.593616</span>  <span class="number">0.884345</span>  <span class="number">1.591431</span></div><div class="line"><span class="number">6</span>  <span class="number">0.141809</span>  <span class="number">0.220390</span>  <span class="number">0.435589</span>  <span class="number">0.192451</span></div><div class="line"><span class="number">7</span> -<span class="number">0.096701</span>  <span class="number">0.803351</span>  <span class="number">1.715071</span> -<span class="number">0.708758</span></div><div class="line"></div><div class="line">In [<span class="number">89</span>]: s = df.iloc[<span class="number">3</span>]</div><div class="line"></div><div class="line">In [<span class="number">90</span>]: df.append(s, ignore_index=True)</div><div class="line">Out[<span class="number">90</span>]: </div><div class="line">          <span class="keyword">A</span>         B         C         D</div><div class="line"><span class="number">0</span>  <span class="number">1.346061</span>  <span class="number">1.511763</span>  <span class="number">1.627081</span> -<span class="number">0.990582</span></div><div class="line"><span class="number">1</span> -<span class="number">0.441652</span>  <span class="number">1.211526</span>  <span class="number">0.268520</span>  <span class="number">0.024580</span></div><div class="line"><span class="number">2</span> -<span class="number">1.577585</span>  <span class="number">0.396823</span> -<span class="number">0.105381</span> -<span class="number">0.532532</span></div><div class="line"><span class="number">3</span>  <span class="number">1.453749</span>  <span class="number">1.208843</span> -<span class="number">0.080952</span> -<span class="number">0.264610</span></div><div class="line"><span class="number">4</span> -<span class="number">0.727965</span> -<span class="number">0.589346</span>  <span class="number">0.339969</span> -<span class="number">0.693205</span></div><div class="line"><span class="number">5</span> -<span class="number">0.339355</span>  <span class="number">0.593616</span>  <span class="number">0.884345</span>  <span class="number">1.591431</span></div><div class="line"><span class="number">6</span>  <span class="number">0.141809</span>  <span class="number">0.220390</span>  <span class="number">0.435589</span>  <span class="number">0.192451</span></div><div class="line"><span class="number">7</span> -<span class="number">0.096701</span>  <span class="number">0.803351</span>  <span class="number">1.715071</span> -<span class="number">0.708758</span></div><div class="line"><span class="number">8</span>  <span class="number">1.453749</span>  <span class="number">1.208843</span> -<span class="number">0.080952</span> -<span class="number">0.264610</span></div></pre></td></tr></table></figure><h2 id="分组（Grouping）"><a href="#分组（Grouping）" class="headerlink" title="分组（Grouping）"></a>分组（Grouping）</h2><p>对于”group by”操作，我们通常是指以下一个或多个操作步骤：</p><ul><li><strong>（Splitting）</strong>按照一些规则将数据分为不同的组；</li><li><strong>（Applying）</strong>对于每组数据分别执行一个函数；</li><li><strong>（Combining）</strong>将结果组合到一个数据结构中；</li></ul><p>详情请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/groupby.html#groupby" target="_blank" rel="external">Grouping section</a></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">91</span>]: df = pd.DataFrame(&#123;<span class="string">'A'</span> : [<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'foo'</span>, <span class="string">'bar'</span>,</div><div class="line">   ....:                           <span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'foo'</span>, <span class="string">'foo'</span>],</div><div class="line">   ....:                    <span class="string">'B'</span> : [<span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>,</div><div class="line">   ....:                           <span class="string">'two'</span>, <span class="string">'two'</span>, <span class="string">'one'</span>, <span class="string">'three'</span>],</div><div class="line">   ....:                    <span class="string">'C'</span> : np<span class="selector-class">.random</span><span class="selector-class">.randn</span>(<span class="number">8</span>),</div><div class="line">   ....:                    <span class="string">'D'</span> : np<span class="selector-class">.random</span><span class="selector-class">.randn</span>(<span class="number">8</span>)&#125;)</div><div class="line">   ....: </div><div class="line"></div><div class="line">In [<span class="number">92</span>]: df</div><div class="line">Out[<span class="number">92</span>]: </div><div class="line">     A      B         C         D</div><div class="line"><span class="number">0</span>  foo    one -<span class="number">1.202872</span> -<span class="number">0.055224</span></div><div class="line"><span class="number">1</span>  bar    one -<span class="number">1.814470</span>  <span class="number">2.395985</span></div><div class="line"><span class="number">2</span>  foo    two  <span class="number">1.018601</span>  <span class="number">1.552825</span></div><div class="line"><span class="number">3</span>  bar  three -<span class="number">0.595447</span>  <span class="number">0.166599</span></div><div class="line"><span class="number">4</span>  foo    two  <span class="number">1.395433</span>  <span class="number">0.047609</span></div><div class="line"><span class="number">5</span>  bar    two -<span class="number">0.392670</span> -<span class="number">0.136473</span></div><div class="line"><span class="number">6</span>  foo    one  <span class="number">0.007207</span> -<span class="number">0.561757</span></div><div class="line"><span class="number">7</span>  foo  three  <span class="number">1.928123</span> -<span class="number">1.623033</span></div></pre></td></tr></table></figure><p>分组，然后将函数总和<code>sum</code>应用于结果组。</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">93</span>]: df.groupby('<span class="keyword">A</span>').sum()</div><div class="line">Out[<span class="number">93</span>]: </div><div class="line">            C        D</div><div class="line"><span class="keyword">A</span>                     </div><div class="line">bar -<span class="number">2.802588</span>  <span class="number">2.42611</span></div><div class="line">foo  <span class="number">3.146492</span> -<span class="number">0.63958</span></div></pre></td></tr></table></figure><p>按多列分组会形成一个分层索引，然后我们应用这个函数。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[94]</span>: <span class="selector-tag">df</span><span class="selector-class">.groupby</span>(<span class="selector-attr">['A','B']</span>)<span class="selector-class">.sum</span>()</div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[94]</span>: </div><div class="line">                  <span class="selector-tag">C</span>         <span class="selector-tag">D</span></div><div class="line"><span class="selector-tag">A</span>   <span class="selector-tag">B</span>                        </div><div class="line"><span class="selector-tag">bar</span> <span class="selector-tag">one</span>   <span class="selector-tag">-1</span><span class="selector-class">.814470</span>  2<span class="selector-class">.395985</span></div><div class="line">    <span class="selector-tag">three</span> <span class="selector-tag">-0</span><span class="selector-class">.595447</span>  0<span class="selector-class">.166599</span></div><div class="line">    <span class="selector-tag">two</span>   <span class="selector-tag">-0</span><span class="selector-class">.392670</span> <span class="selector-tag">-0</span><span class="selector-class">.136473</span></div><div class="line"><span class="selector-tag">foo</span> <span class="selector-tag">one</span>   <span class="selector-tag">-1</span><span class="selector-class">.195665</span> <span class="selector-tag">-0</span><span class="selector-class">.616981</span></div><div class="line">    <span class="selector-tag">three</span>  1<span class="selector-class">.928123</span> <span class="selector-tag">-1</span><span class="selector-class">.623033</span></div><div class="line">    <span class="selector-tag">two</span>    2<span class="selector-class">.414034</span>  1<span class="selector-class">.600434</span></div></pre></td></tr></table></figure><h2 id="Reshaping"><a href="#Reshaping" class="headerlink" title="Reshaping"></a>Reshaping</h2><p>详情请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/advanced.html#advanced-hierarchical" target="_blank" rel="external">Hierarchical Indexing</a>和<a href="http://pandas.pydata.org/pandas-docs/stable/reshaping.html#reshaping-stacking" target="_blank" rel="external">Reshaping</a>。</p><h3 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h3><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">In</span> [<span class="number">95</span>]: tuples = list(zip(*[[<span class="string">'bar'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>, <span class="string">'baz'</span>,</div><div class="line">   ....:                      <span class="string">'foo'</span>, <span class="string">'foo'</span>, <span class="string">'qux'</span>, <span class="string">'qux'</span>],</div><div class="line">   ....:                     [<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>,</div><div class="line">   ....:                      <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>]]))</div><div class="line">   ....: </div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">96</span>]: index = pd.<span class="symbol">MultiIndex</span>.from_tuples(tuples, names=[<span class="string">'first'</span>, <span class="string">'second'</span>])</div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">97</span>]: df = pd.<span class="symbol">DataFrame</span>(np.random.randn(<span class="number">8</span>, <span class="number">2</span>), index=index, columns=[<span class="string">'A'</span>, <span class="string">'B'</span>])</div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">98</span>]: df2 = df[:<span class="number">4</span>]</div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">99</span>]: df2</div><div class="line"><span class="symbol">Out</span>[<span class="number">99</span>]: </div><div class="line">                     <span class="symbol">A</span>         <span class="symbol">B</span></div><div class="line">first second                    </div><div class="line">bar   one     <span class="number">0.029399</span> <span class="number">-0.542108</span></div><div class="line">      two     <span class="number">0.282696</span> <span class="number">-0.087302</span></div><div class="line">baz   one    <span class="number">-1.575170</span>  <span class="number">1.771208</span></div><div class="line">      two     <span class="number">0.816482</span>  <span class="number">1.100230</span></div></pre></td></tr></table></figure><p><code>stack()</code>方法“压缩”了DataFrame列中的级别。</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">100</span>]: stacked = df2.stack()</div><div class="line"></div><div class="line">In [<span class="number">101</span>]: stacked</div><div class="line">Out[<span class="number">101</span>]: </div><div class="line">first  second   </div><div class="line">bar    one     <span class="keyword">A</span>    <span class="number">0.029399</span></div><div class="line">               B   -<span class="number">0.542108</span></div><div class="line">       two     <span class="keyword">A</span>    <span class="number">0.282696</span></div><div class="line">               B   -<span class="number">0.087302</span></div><div class="line">baz    one     <span class="keyword">A</span>   -<span class="number">1.575170</span></div><div class="line">               B    <span class="number">1.771208</span></div><div class="line">       two     <span class="keyword">A</span>    <span class="number">0.816482</span></div><div class="line">               B    <span class="number">1.100230</span></div><div class="line">dtype: float64</div></pre></td></tr></table></figure><p>对于“堆叠的(stacked)”DataFrame或Series（以MultiIndex为索引），<code>stack()</code>的反向操作是<code>unstack()</code>，默认情况下，它将卸载<strong>最后一层</strong>：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[102]</span>: <span class="selector-tag">stacked</span><span class="selector-class">.unstack</span>()</div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[102]</span>: </div><div class="line">                     <span class="selector-tag">A</span>         <span class="selector-tag">B</span></div><div class="line"><span class="selector-tag">first</span> <span class="selector-tag">second</span>                    </div><div class="line"><span class="selector-tag">bar</span>   <span class="selector-tag">one</span>     0<span class="selector-class">.029399</span> <span class="selector-tag">-0</span><span class="selector-class">.542108</span></div><div class="line">      <span class="selector-tag">two</span>     0<span class="selector-class">.282696</span> <span class="selector-tag">-0</span><span class="selector-class">.087302</span></div><div class="line"><span class="selector-tag">baz</span>   <span class="selector-tag">one</span>    <span class="selector-tag">-1</span><span class="selector-class">.575170</span>  1<span class="selector-class">.771208</span></div><div class="line">      <span class="selector-tag">two</span>     0<span class="selector-class">.816482</span>  1<span class="selector-class">.100230</span></div><div class="line"></div><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[103]</span>: <span class="selector-tag">stacked</span><span class="selector-class">.unstack</span>(1)</div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[103]</span>: </div><div class="line"><span class="selector-tag">second</span>        <span class="selector-tag">one</span>       <span class="selector-tag">two</span></div><div class="line"><span class="selector-tag">first</span>                      </div><div class="line"><span class="selector-tag">bar</span>   <span class="selector-tag">A</span>  0<span class="selector-class">.029399</span>  0<span class="selector-class">.282696</span></div><div class="line">      <span class="selector-tag">B</span> <span class="selector-tag">-0</span><span class="selector-class">.542108</span> <span class="selector-tag">-0</span><span class="selector-class">.087302</span></div><div class="line"><span class="selector-tag">baz</span>   <span class="selector-tag">A</span> <span class="selector-tag">-1</span><span class="selector-class">.575170</span>  0<span class="selector-class">.816482</span></div><div class="line">      <span class="selector-tag">B</span>  1<span class="selector-class">.771208</span>  1<span class="selector-class">.100230</span></div><div class="line"></div><div class="line"><span class="selector-tag">In</span> <span class="selector-attr">[104]</span>: <span class="selector-tag">stacked</span><span class="selector-class">.unstack</span>(0)</div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[104]</span>: </div><div class="line"><span class="selector-tag">first</span>          <span class="selector-tag">bar</span>       <span class="selector-tag">baz</span></div><div class="line"><span class="selector-tag">second</span>                      </div><div class="line"><span class="selector-tag">one</span>    <span class="selector-tag">A</span>  0<span class="selector-class">.029399</span> <span class="selector-tag">-1</span><span class="selector-class">.575170</span></div><div class="line">       <span class="selector-tag">B</span> <span class="selector-tag">-0</span><span class="selector-class">.542108</span>  1<span class="selector-class">.771208</span></div><div class="line"><span class="selector-tag">two</span>    <span class="selector-tag">A</span>  0<span class="selector-class">.282696</span>  0<span class="selector-class">.816482</span></div><div class="line">       <span class="selector-tag">B</span> <span class="selector-tag">-0</span><span class="selector-class">.087302</span>  1<span class="selector-class">.100230</span></div></pre></td></tr></table></figure><h3 id="数据透视表"><a href="#数据透视表" class="headerlink" title="数据透视表"></a>数据透视表</h3><p>详情请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/reshaping.html#reshaping-pivot" target="_blank" rel="external">Pivot Tables</a></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">105</span>]: df = pd.DataFrame(&#123;'<span class="keyword">A</span>' : ['one', 'one', 'two', 'three'] * <span class="number">3</span>,</div><div class="line">   .....:                    'B' : ['<span class="keyword">A</span>', 'B', 'C'] * <span class="number">4</span>,</div><div class="line">   .....:                    'C' : ['foo', 'foo', 'foo', 'bar', 'bar', 'bar'] * <span class="number">2</span>,</div><div class="line">   .....:                    'D' : np.random.randn(<span class="number">12</span>),</div><div class="line">   .....:                    'E' : np.random.randn(<span class="number">12</span>)&#125;)</div><div class="line">   .....: </div><div class="line"></div><div class="line">In [<span class="number">106</span>]: df</div><div class="line">Out[<span class="number">106</span>]: </div><div class="line">        <span class="keyword">A</span>  B    C         D         E</div><div class="line"><span class="number">0</span>     one  <span class="keyword">A</span>  foo  <span class="number">1.418757</span> -<span class="number">0.179666</span></div><div class="line"><span class="number">1</span>     one  B  foo -<span class="number">1.879024</span>  <span class="number">1.291836</span></div><div class="line"><span class="number">2</span>     two  C  foo  <span class="number">0.536826</span> -<span class="number">0.009614</span></div><div class="line"><span class="number">3</span>   three  <span class="keyword">A</span>  bar  <span class="number">1.006160</span>  <span class="number">0.392149</span></div><div class="line"><span class="number">4</span>     one  B  bar -<span class="number">0.029716</span>  <span class="number">0.264599</span></div><div class="line"><span class="number">5</span>     one  C  bar -<span class="number">1.146178</span> -<span class="number">0.057409</span></div><div class="line"><span class="number">6</span>     two  <span class="keyword">A</span>  foo  <span class="number">0.100900</span> -<span class="number">1.425638</span></div><div class="line"><span class="number">7</span>   three  B  foo -<span class="number">1.035018</span>  <span class="number">1.024098</span></div><div class="line"><span class="number">8</span>     one  C  foo  <span class="number">0.314665</span> -<span class="number">0.106062</span></div><div class="line"><span class="number">9</span>     one  <span class="keyword">A</span>  bar -<span class="number">0.773723</span>  <span class="number">1.824375</span></div><div class="line"><span class="number">10</span>    two  B  bar -<span class="number">1.170653</span>  <span class="number">0.595974</span></div><div class="line"><span class="number">11</span>  three  C  bar  <span class="number">0.648740</span>  <span class="number">1.167115</span></div></pre></td></tr></table></figure><p>我们可以很容易地从这些数据生成数据透视表：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">107</span>]: pd.pivot_table(df, values='D', index=['<span class="keyword">A</span>', 'B'], columns=['C'])</div><div class="line">Out[<span class="number">107</span>]: </div><div class="line">C             bar       foo</div><div class="line"><span class="keyword">A</span>     B                    </div><div class="line">one   <span class="keyword">A</span> -<span class="number">0.773723</span>  <span class="number">1.418757</span></div><div class="line">      B -<span class="number">0.029716</span> -<span class="number">1.879024</span></div><div class="line">      C -<span class="number">1.146178</span>  <span class="number">0.314665</span></div><div class="line">three <span class="keyword">A</span>  <span class="number">1.006160</span>       NaN</div><div class="line">      B       NaN -<span class="number">1.035018</span></div><div class="line">      C  <span class="number">0.648740</span>       NaN</div><div class="line">two   <span class="keyword">A</span>       NaN  <span class="number">0.100900</span></div><div class="line">      B -<span class="number">1.170653</span>       NaN</div><div class="line">      C       NaN  <span class="number">0.536826</span></div></pre></td></tr></table></figure><h2 id="时间序列"><a href="#时间序列" class="headerlink" title="时间序列"></a>时间序列</h2><p>Pandas在对频率转换进行重新采样时拥有简单、强大且高效的功能（如将按秒采样的数据转换为按5分钟为单位进行采样的数据）。这种操作在金融领域非常常见。</p><p>详情请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/timeseries.html#timeseries" target="_blank" rel="external">Time Series section</a></p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">In</span> [<span class="number">108</span>]: rng = pd.date_range(<span class="string">'1/1/2012'</span>, periods=<span class="number">100</span>, freq=<span class="string">'S'</span>)</div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">109</span>]: ts = pd.Series(np.random.randint(<span class="number">0</span>, <span class="number">500</span>, len(rng)), <span class="keyword">index</span>=rng)</div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">110</span>]: ts.resample(<span class="string">'5Min'</span>).sum()</div><div class="line"><span class="keyword">Out</span>[<span class="number">110</span>]: </div><div class="line"><span class="number">2012</span>-<span class="number">01</span>-<span class="number">01</span>    <span class="number">25083</span></div><div class="line">Freq: <span class="number">5</span>T, dtype: int64</div></pre></td></tr></table></figure><p>时区表示</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">111</span>]: rng = pd.date_range('<span class="number">3/6/2012</span> <span class="number">00</span>:<span class="number">00</span>', periods=<span class="number">5</span>, freq='D')</div><div class="line"></div><div class="line">In [<span class="number">112</span>]: ts = pd.Series(np.random.randn(len(rng)), rng)</div><div class="line"></div><div class="line">In [<span class="number">113</span>]: ts</div><div class="line">Out[<span class="number">113</span>]: </div><div class="line"><span class="number">2012-03-06</span>    <span class="number">0.464000</span></div><div class="line"><span class="number">2012-03-07</span>    <span class="number">0.227371</span></div><div class="line"><span class="number">2012-03-08</span>   -<span class="number">0.496922</span></div><div class="line"><span class="number">2012-03-09</span>    <span class="number">0.306389</span></div><div class="line"><span class="number">2012-03-10</span>   -<span class="number">2.290613</span></div><div class="line">Freq: D, dtype: float64</div><div class="line"></div><div class="line">In [<span class="number">114</span>]: ts_utc = ts.tz_localize('UTC')</div><div class="line"></div><div class="line">In [<span class="number">115</span>]: ts_utc</div><div class="line">Out[<span class="number">115</span>]: </div><div class="line"><span class="number">2012-03-06</span> <span class="number">00:00:00+00</span>:<span class="number">00</span>    <span class="number">0.464000</span></div><div class="line"><span class="number">2012-03-07</span> <span class="number">00:00:00+00</span>:<span class="number">00</span>    <span class="number">0.227371</span></div><div class="line"><span class="number">2012-03-08</span> <span class="number">00:00:00+00</span>:<span class="number">00</span>   -<span class="number">0.496922</span></div><div class="line"><span class="number">2012-03-09</span> <span class="number">00:00:00+00</span>:<span class="number">00</span>    <span class="number">0.306389</span></div><div class="line"><span class="number">2012-03-10</span> <span class="number">00:00:00+00</span>:<span class="number">00</span>   -<span class="number">2.290613</span></div><div class="line">Freq: D, dtype: float64</div></pre></td></tr></table></figure><p>转换成其他时区</p><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">In <span class="selector-attr">[116]</span>: <span class="selector-tag">ts_utc</span><span class="selector-class">.tz_convert</span>(<span class="string">'US/Eastern'</span>)</div><div class="line"><span class="selector-tag">Out</span><span class="selector-attr">[116]</span>: </div><div class="line"><span class="selector-tag">2012-03-05</span> <span class="selector-tag">19</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00-05</span><span class="selector-pseudo">:00</span>    <span class="selector-tag">0</span><span class="selector-class">.464000</span></div><div class="line"><span class="selector-tag">2012-03-06</span> <span class="selector-tag">19</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00-05</span><span class="selector-pseudo">:00</span>    <span class="selector-tag">0</span><span class="selector-class">.227371</span></div><div class="line"><span class="selector-tag">2012-03-07</span> <span class="selector-tag">19</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00-05</span><span class="selector-pseudo">:00</span>   <span class="selector-tag">-0</span><span class="selector-class">.496922</span></div><div class="line"><span class="selector-tag">2012-03-08</span> <span class="selector-tag">19</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00-05</span><span class="selector-pseudo">:00</span>    <span class="selector-tag">0</span><span class="selector-class">.306389</span></div><div class="line"><span class="selector-tag">2012-03-09</span> <span class="selector-tag">19</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00-05</span><span class="selector-pseudo">:00</span>   <span class="selector-tag">-2</span><span class="selector-class">.290613</span></div><div class="line"><span class="selector-tag">Freq</span>: <span class="selector-tag">D</span>, <span class="selector-tag">dtype</span>: <span class="selector-tag">float64</span></div></pre></td></tr></table></figure><p>在时间跨度表示之间进行转换</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">117</span>]: rng = pd.date_range('<span class="number">1/1/2012</span>', periods=<span class="number">5</span>, freq='M')</div><div class="line"></div><div class="line">In [<span class="number">118</span>]: ts = pd.Series(np.random.randn(len(rng)), index=rng)</div><div class="line"></div><div class="line">In [<span class="number">119</span>]: ts</div><div class="line">Out[<span class="number">119</span>]: </div><div class="line"><span class="number">2012-01-31</span>   -<span class="number">1.134623</span></div><div class="line"><span class="number">2012-02-29</span>   -<span class="number">1.561819</span></div><div class="line"><span class="number">2012-03-31</span>   -<span class="number">0.260838</span></div><div class="line"><span class="number">2012-04-30</span>    <span class="number">0.281957</span></div><div class="line"><span class="number">2012-05-31</span>    <span class="number">1.523962</span></div><div class="line">Freq: M, dtype: float64</div><div class="line"></div><div class="line">In [<span class="number">120</span>]: ps = ts.to_period()</div><div class="line"></div><div class="line">In [<span class="number">121</span>]: ps</div><div class="line">Out[<span class="number">121</span>]: </div><div class="line"><span class="number">2012</span>-<span class="number">01</span>   -<span class="number">1.134623</span></div><div class="line"><span class="number">2012</span>-<span class="number">02</span>   -<span class="number">1.561819</span></div><div class="line"><span class="number">2012</span>-<span class="number">03</span>   -<span class="number">0.260838</span></div><div class="line"><span class="number">2012</span>-<span class="number">04</span>    <span class="number">0.281957</span></div><div class="line"><span class="number">2012</span>-<span class="number">05</span>    <span class="number">1.523962</span></div><div class="line">Freq: M, dtype: float64</div><div class="line"></div><div class="line">In [<span class="number">122</span>]: ps.to_timestamp()</div><div class="line">Out[<span class="number">122</span>]: </div><div class="line"><span class="number">2012-01-01</span>   -<span class="number">1.134623</span></div><div class="line"><span class="number">2012-02-01</span>   -<span class="number">1.561819</span></div><div class="line"><span class="number">2012-03-01</span>   -<span class="number">0.260838</span></div><div class="line"><span class="number">2012-04-01</span>    <span class="number">0.281957</span></div><div class="line"><span class="number">2012-05-01</span>    <span class="number">1.523962</span></div><div class="line">Freq: MS, dtype: float64</div></pre></td></tr></table></figure><p>周期和时间戳之间的转换可以使用一些方便的算术功能。在下面的例子中，我们将季度结束时间从11月份转换为季末结束时的上午9点：</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">In</span> [<span class="number">123</span>]: prng = pd.period_range(<span class="string">'1990Q1'</span>, <span class="string">'2000Q4'</span>, freq=<span class="string">'Q-NOV'</span>)</div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">124</span>]: ts = pd.Series(np.random.randn(len(prng)), prng)</div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">125</span>]: ts.<span class="keyword">index</span> = (prng.asfreq(<span class="string">'M'</span>, <span class="string">'e'</span>) + <span class="number">1</span>).asfreq(<span class="string">'H'</span>, <span class="string">'s'</span>) + <span class="number">9</span></div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">126</span>]: ts.head()</div><div class="line"><span class="keyword">Out</span>[<span class="number">126</span>]: </div><div class="line"><span class="number">1990</span>-<span class="number">03</span>-<span class="number">01</span> <span class="number">09</span>:<span class="number">00</span>   -<span class="number">0.902937</span></div><div class="line"><span class="number">1990</span>-<span class="number">06</span>-<span class="number">01</span> <span class="number">09</span>:<span class="number">00</span>    <span class="number">0.068159</span></div><div class="line"><span class="number">1990</span>-<span class="number">09</span>-<span class="number">01</span> <span class="number">09</span>:<span class="number">00</span>   -<span class="number">0.057873</span></div><div class="line"><span class="number">1990</span>-<span class="number">12</span>-<span class="number">01</span> <span class="number">09</span>:<span class="number">00</span>   -<span class="number">0.368204</span></div><div class="line"><span class="number">1991</span>-<span class="number">03</span>-<span class="number">01</span> <span class="number">09</span>:<span class="number">00</span>   -<span class="number">1.144073</span></div><div class="line">Freq: H, dtype: float64</div></pre></td></tr></table></figure><h2 id="Categorical"><a href="#Categorical" class="headerlink" title="Categorical"></a>Categorical</h2><p>pandas可以在DataFrame中引入categorical数据。详情请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/categorical.html#categorical" target="_blank" rel="external">categorical introduction</a>和<a href="http://pandas.pydata.org/pandas-docs/stable/api.html#api-categorical" target="_blank" rel="external">API documentation</a>。</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">In</span> [<span class="number">127</span>]: df = pd.<span class="symbol">DataFrame</span>(&#123;<span class="string">"id"</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], <span class="string">"raw_grade"</span>:[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'e'</span>]&#125;)</div></pre></td></tr></table></figure><p>将原始的grade转换为Categorical数据类型：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">128</span>]: df[<span class="string">"grade"</span>] = df[<span class="string">"raw_grade"</span>].astype(<span class="string">"category"</span>)</div><div class="line"></div><div class="line">In [<span class="number">129</span>]: df[<span class="string">"grade"</span>]</div><div class="line">Out[<span class="number">129</span>]: </div><div class="line"><span class="number">0</span>    <span class="selector-tag">a</span></div><div class="line"><span class="number">1</span>    <span class="selector-tag">b</span></div><div class="line"><span class="number">2</span>    <span class="selector-tag">b</span></div><div class="line"><span class="number">3</span>    <span class="selector-tag">a</span></div><div class="line"><span class="number">4</span>    <span class="selector-tag">a</span></div><div class="line"><span class="number">5</span>    e</div><div class="line">Name: grade, dtype: category</div><div class="line">Categories (<span class="number">3</span>, object): [<span class="selector-tag">a</span>, <span class="selector-tag">b</span>, e]</div></pre></td></tr></table></figure><p>将类别重命名为更有意义的名称</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">In</span> [<span class="number">130</span>]: df[<span class="string">"grade"</span>].cat.categories = [<span class="string">"very good"</span>, <span class="string">"good"</span>, <span class="string">"very bad"</span>]</div></pre></td></tr></table></figure><p>重新排列类别并同时添加缺少的类别（Series .cat下的方法默认返回一个新的系列）。</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">131</span>]: df[<span class="string">"grade"</span>] = df[<span class="string">"grade"</span>].cat.set_categories([<span class="string">"very bad"</span>, <span class="string">"bad"</span>, <span class="string">"medium"</span>, <span class="string">"good"</span>, <span class="string">"very good"</span>])</div><div class="line"></div><div class="line"><span class="symbol">In</span> [<span class="number">132</span>]: df[<span class="string">"grade"</span>]</div><div class="line"><span class="symbol">Out</span>[<span class="number">132</span>]: </div><div class="line"><span class="number">0</span>    very good</div><div class="line"><span class="number">1</span>         good</div><div class="line"><span class="number">2</span>         good</div><div class="line"><span class="number">3</span>    very good</div><div class="line"><span class="number">4</span>    very good</div><div class="line"><span class="number">5</span>     very bad</div><div class="line"><span class="symbol">Name</span>: grade, dtype: category</div><div class="line"><span class="symbol">Categories</span> (<span class="number">5</span>, object): [very bad, bad, medium, good, very good]</div></pre></td></tr></table></figure><p>排序是按类别排序的，而不是词汇顺序。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">133</span>]: df.sort_values(by=<span class="string">"grade"</span>)</div><div class="line">Out[<span class="number">133</span>]: </div><div class="line">   id raw_grade      grade</div><div class="line"><span class="number">5</span>   <span class="number">6</span>         e   very bad</div><div class="line"><span class="number">1</span>   <span class="number">2</span>         <span class="selector-tag">b</span>       good</div><div class="line"><span class="number">2</span>   <span class="number">3</span>         <span class="selector-tag">b</span>       good</div><div class="line"><span class="number">0</span>   <span class="number">1</span>         <span class="selector-tag">a</span>  very good</div><div class="line"><span class="number">3</span>   <span class="number">4</span>         <span class="selector-tag">a</span>  very good</div><div class="line"><span class="number">4</span>   <span class="number">5</span>         <span class="selector-tag">a</span>  very good</div></pre></td></tr></table></figure><h2 id="画图"><a href="#画图" class="headerlink" title="画图"></a>画图</h2><p><a href="http://pandas.pydata.org/pandas-docs/stable/visualization.html#visualization" target="_blank" rel="external">Plotting</a>文档</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">135</span>]: ts = pd.Series(np<span class="selector-class">.random</span><span class="selector-class">.randn</span>(<span class="number">1000</span>), index=pd.date_range(<span class="string">'1/1/2000'</span>, periods=<span class="number">1000</span>))</div><div class="line"></div><div class="line">In [<span class="number">136</span>]: ts = ts.cumsum()</div><div class="line"></div><div class="line">In [<span class="number">137</span>]: ts.plot()</div><div class="line">Out[<span class="number">137</span>]: &lt;matplotlib<span class="selector-class">.axes</span>._subplots<span class="selector-class">.AxesSubplot</span> at <span class="number">0</span>x1122ad630&gt;</div></pre></td></tr></table></figure><p><img src="http://pandas.pydata.org/pandas-docs/stable/_images/series_plot_basic.png" alt=""></p><p>在DataFrame上，<code>plot()</code>方便绘制所有带标签的列：</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">In</span> [<span class="number">138</span>]: df = pd.DataFrame(np.random.randn(<span class="number">1000</span>, <span class="number">4</span>), <span class="keyword">index</span>=ts.<span class="keyword">index</span>,</div><div class="line">   .....:                   columns=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>])</div><div class="line">   .....: </div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">139</span>]: df = df.cumsum()</div><div class="line"></div><div class="line"><span class="keyword">In</span> [<span class="number">140</span>]: plt.figure(); df.plot(); plt.legend(loc=<span class="string">'best'</span>)</div><div class="line"><span class="keyword">Out</span>[<span class="number">140</span>]: &lt;matplotlib.legend.Legend at <span class="number">0</span>x115033cf8&gt;</div></pre></td></tr></table></figure><p><img src="http://pandas.pydata.org/pandas-docs/stable/_images/frame_plot_basic.png" alt=""></p><h2 id="导入和保存数据"><a href="#导入和保存数据" class="headerlink" title="导入和保存数据"></a>导入和保存数据</h2><h3 id="CSV"><a href="#CSV" class="headerlink" title="CSV"></a>CSV</h3><p><a href="http://pandas.pydata.org/pandas-docs/stable/io.html#io-store-in-csv" target="_blank" rel="external">Writing to a csv file</a></p><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">In <span class="selector-attr">[141]</span>: <span class="selector-tag">df</span><span class="selector-class">.to_csv</span>(<span class="string">'foo.csv'</span>)</div></pre></td></tr></table></figure><p><a href="http://pandas.pydata.org/pandas-docs/stable/io.html#io-read-csv-table" target="_blank" rel="external">Reading from a csv file</a></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">142</span>]: pd.read_csv('foo.csv')</div><div class="line">Out[<span class="number">142</span>]: </div><div class="line">     Unnamed: <span class="number">0</span>          <span class="keyword">A</span>          B         C          D</div><div class="line"><span class="number">0</span>    <span class="number">2000-01-01</span>   <span class="number">0.266457</span>  -<span class="number">0.399641</span> -<span class="number">0.219582</span>   <span class="number">1.186860</span></div><div class="line"><span class="number">1</span>    <span class="number">2000-01-02</span>  -<span class="number">1.170732</span>  -<span class="number">0.345873</span>  <span class="number">1.653061</span>  -<span class="number">0.282953</span></div><div class="line"><span class="number">2</span>    <span class="number">2000-01-03</span>  -<span class="number">1.734933</span>   <span class="number">0.530468</span>  <span class="number">2.060811</span>  -<span class="number">0.515536</span></div><div class="line"><span class="number">3</span>    <span class="number">2000-01-04</span>  -<span class="number">1.555121</span>   <span class="number">1.452620</span>  <span class="number">0.239859</span>  -<span class="number">1.156896</span></div><div class="line"><span class="number">4</span>    <span class="number">2000-01-05</span>   <span class="number">0.578117</span>   <span class="number">0.511371</span>  <span class="number">0.103552</span>  -<span class="number">2.428202</span></div><div class="line"><span class="number">5</span>    <span class="number">2000-01-06</span>   <span class="number">0.478344</span>   <span class="number">0.449933</span> -<span class="number">0.741620</span>  -<span class="number">1.962409</span></div><div class="line"><span class="number">6</span>    <span class="number">2000-01-07</span>   <span class="number">1.235339</span>  -<span class="number">0.091757</span> -<span class="number">1.543861</span>  -<span class="number">1.084753</span></div><div class="line">..          ...        ...        ...       ...        ...</div><div class="line"><span class="number">993</span>  <span class="number">2002-09-20</span> -<span class="number">10.628548</span>  -<span class="number">9.153563</span> -<span class="number">7.883146</span>  <span class="number">28.313940</span></div><div class="line"><span class="number">994</span>  <span class="number">2002-09-21</span> -<span class="number">10.390377</span>  -<span class="number">8.727491</span> -<span class="number">6.399645</span>  <span class="number">30.914107</span></div><div class="line"><span class="number">995</span>  <span class="number">2002-09-22</span>  -<span class="number">8.985362</span>  -<span class="number">8.485624</span> -<span class="number">4.669462</span>  <span class="number">31.367740</span></div><div class="line"><span class="number">996</span>  <span class="number">2002-09-23</span>  -<span class="number">9.558560</span>  -<span class="number">8.781216</span> -<span class="number">4.499815</span>  <span class="number">30.518439</span></div><div class="line"><span class="number">997</span>  <span class="number">2002-09-24</span>  -<span class="number">9.902058</span>  -<span class="number">9.340490</span> -<span class="number">4.386639</span>  <span class="number">30.105593</span></div><div class="line"><span class="number">998</span>  <span class="number">2002-09-25</span> -<span class="number">10.216020</span>  -<span class="number">9.480682</span> -<span class="number">3.933802</span>  <span class="number">29.758560</span></div><div class="line"><span class="number">999</span>  <span class="number">2002-09-26</span> -<span class="number">11.856774</span> -<span class="number">10.671012</span> -<span class="number">3.216025</span>  <span class="number">29.369368</span></div><div class="line"></div><div class="line">[<span class="number">1000</span> rows x <span class="number">5</span> columns]</div></pre></td></tr></table></figure><h3 id="HDF5"><a href="#HDF5" class="headerlink" title="HDF5"></a>HDF5</h3><p>从<a href="http://pandas.pydata.org/pandas-docs/stable/io.html#io-hdf5" target="_blank" rel="external">HDFStores</a>读取和写入数据</p><p>写入HDF5存储：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">In <span class="selector-attr">[143]</span>: <span class="selector-tag">df</span><span class="selector-class">.to_hdf</span>(<span class="string">'foo.h5'</span>,<span class="string">'df'</span>)</div></pre></td></tr></table></figure><p>从HDF5存储中读取：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">144</span>]: pd.read_hdf('foo.h5','df')</div><div class="line">Out[<span class="number">144</span>]: </div><div class="line">                    <span class="keyword">A</span>          B         C          D</div><div class="line"><span class="number">2000-01-01</span>   <span class="number">0.266457</span>  -<span class="number">0.399641</span> -<span class="number">0.219582</span>   <span class="number">1.186860</span></div><div class="line"><span class="number">2000-01-02</span>  -<span class="number">1.170732</span>  -<span class="number">0.345873</span>  <span class="number">1.653061</span>  -<span class="number">0.282953</span></div><div class="line"><span class="number">2000-01-03</span>  -<span class="number">1.734933</span>   <span class="number">0.530468</span>  <span class="number">2.060811</span>  -<span class="number">0.515536</span></div><div class="line"><span class="number">2000-01-04</span>  -<span class="number">1.555121</span>   <span class="number">1.452620</span>  <span class="number">0.239859</span>  -<span class="number">1.156896</span></div><div class="line"><span class="number">2000-01-05</span>   <span class="number">0.578117</span>   <span class="number">0.511371</span>  <span class="number">0.103552</span>  -<span class="number">2.428202</span></div><div class="line"><span class="number">2000-01-06</span>   <span class="number">0.478344</span>   <span class="number">0.449933</span> -<span class="number">0.741620</span>  -<span class="number">1.962409</span></div><div class="line"><span class="number">2000-01-07</span>   <span class="number">1.235339</span>  -<span class="number">0.091757</span> -<span class="number">1.543861</span>  -<span class="number">1.084753</span></div><div class="line">...               ...        ...       ...        ...</div><div class="line"><span class="number">2002-09-20</span> -<span class="number">10.628548</span>  -<span class="number">9.153563</span> -<span class="number">7.883146</span>  <span class="number">28.313940</span></div><div class="line"><span class="number">2002-09-21</span> -<span class="number">10.390377</span>  -<span class="number">8.727491</span> -<span class="number">6.399645</span>  <span class="number">30.914107</span></div><div class="line"><span class="number">2002-09-22</span>  -<span class="number">8.985362</span>  -<span class="number">8.485624</span> -<span class="number">4.669462</span>  <span class="number">31.367740</span></div><div class="line"><span class="number">2002-09-23</span>  -<span class="number">9.558560</span>  -<span class="number">8.781216</span> -<span class="number">4.499815</span>  <span class="number">30.518439</span></div><div class="line"><span class="number">2002-09-24</span>  -<span class="number">9.902058</span>  -<span class="number">9.340490</span> -<span class="number">4.386639</span>  <span class="number">30.105593</span></div><div class="line"><span class="number">2002-09-25</span> -<span class="number">10.216020</span>  -<span class="number">9.480682</span> -<span class="number">3.933802</span>  <span class="number">29.758560</span></div><div class="line"><span class="number">2002-09-26</span> -<span class="number">11.856774</span> -<span class="number">10.671012</span> -<span class="number">3.216025</span>  <span class="number">29.369368</span></div><div class="line"></div><div class="line">[<span class="number">1000</span> rows x <span class="number">4</span> columns]</div></pre></td></tr></table></figure><h3 id="Excel"><a href="#Excel" class="headerlink" title="Excel"></a>Excel</h3><p>从<a href="http://pandas.pydata.org/pandas-docs/stable/io.html#io-excel" target="_blank" rel="external">MS Excel</a>中读取和写入数据</p><p>写入一个excel文件</p><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">In <span class="selector-attr">[145]</span>: <span class="selector-tag">df</span><span class="selector-class">.to_excel</span>(<span class="string">'foo.xlsx'</span>, sheet_name=<span class="string">'Sheet1'</span>)</div></pre></td></tr></table></figure><p>读取一个excel文件</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">146</span>]: pd.read_excel('foo.xlsx', 'Sheet1', index_col=None, na_values=['NA'])</div><div class="line">Out[<span class="number">146</span>]: </div><div class="line">                    <span class="keyword">A</span>          B         C          D</div><div class="line"><span class="number">2000-01-01</span>   <span class="number">0.266457</span>  -<span class="number">0.399641</span> -<span class="number">0.219582</span>   <span class="number">1.186860</span></div><div class="line"><span class="number">2000-01-02</span>  -<span class="number">1.170732</span>  -<span class="number">0.345873</span>  <span class="number">1.653061</span>  -<span class="number">0.282953</span></div><div class="line"><span class="number">2000-01-03</span>  -<span class="number">1.734933</span>   <span class="number">0.530468</span>  <span class="number">2.060811</span>  -<span class="number">0.515536</span></div><div class="line"><span class="number">2000-01-04</span>  -<span class="number">1.555121</span>   <span class="number">1.452620</span>  <span class="number">0.239859</span>  -<span class="number">1.156896</span></div><div class="line"><span class="number">2000-01-05</span>   <span class="number">0.578117</span>   <span class="number">0.511371</span>  <span class="number">0.103552</span>  -<span class="number">2.428202</span></div><div class="line"><span class="number">2000-01-06</span>   <span class="number">0.478344</span>   <span class="number">0.449933</span> -<span class="number">0.741620</span>  -<span class="number">1.962409</span></div><div class="line"><span class="number">2000-01-07</span>   <span class="number">1.235339</span>  -<span class="number">0.091757</span> -<span class="number">1.543861</span>  -<span class="number">1.084753</span></div><div class="line">...               ...        ...       ...        ...</div><div class="line"><span class="number">2002-09-20</span> -<span class="number">10.628548</span>  -<span class="number">9.153563</span> -<span class="number">7.883146</span>  <span class="number">28.313940</span></div><div class="line"><span class="number">2002-09-21</span> -<span class="number">10.390377</span>  -<span class="number">8.727491</span> -<span class="number">6.399645</span>  <span class="number">30.914107</span></div><div class="line"><span class="number">2002-09-22</span>  -<span class="number">8.985362</span>  -<span class="number">8.485624</span> -<span class="number">4.669462</span>  <span class="number">31.367740</span></div><div class="line"><span class="number">2002-09-23</span>  -<span class="number">9.558560</span>  -<span class="number">8.781216</span> -<span class="number">4.499815</span>  <span class="number">30.518439</span></div><div class="line"><span class="number">2002-09-24</span>  -<span class="number">9.902058</span>  -<span class="number">9.340490</span> -<span class="number">4.386639</span>  <span class="number">30.105593</span></div><div class="line"><span class="number">2002-09-25</span> -<span class="number">10.216020</span>  -<span class="number">9.480682</span> -<span class="number">3.933802</span>  <span class="number">29.758560</span></div><div class="line"><span class="number">2002-09-26</span> -<span class="number">11.856774</span> -<span class="number">10.671012</span> -<span class="number">3.216025</span>  <span class="number">29.369368</span></div><div class="line"></div><div class="line">[<span class="number">1000</span> rows x <span class="number">4</span> columns]</div></pre></td></tr></table></figure><h2 id="陷阱"><a href="#陷阱" class="headerlink" title="陷阱"></a>陷阱</h2><p>如果你正在尝试一个操作，你会看到一个异常：</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt;<span class="built_in"> if </span>pd.Series([False, True, False]):</div><div class="line">    print(<span class="string">"I was true"</span>)</div><div class="line">Traceback</div><div class="line"><span class="keyword">    .</span>..</div><div class="line">ValueError: The truth value of an<span class="built_in"> array </span>is ambiguous. Use a.empty, a.any()<span class="built_in"> or </span>a.all().</div></pre></td></tr></table></figure><p>请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/basics.html#basics-compare" target="_blank" rel="external">Comparisons</a>以获取解释以及如何处理。</p><p>同时请参阅<a href="http://pandas.pydata.org/pandas-docs/stable/gotchas.html#gotchas" target="_blank" rel="external">Gotchas</a>。</p>]]></content:encoded>
      
      <comments>http://studyai.site/2017/11/30/10%E5%88%86%E9%92%9F%E4%B8%8A%E6%89%8BPandas/#disqus_thread</comments>
    </item>
    
    <item>
      <title>【原创】不用一句深度学习术语来讲解神经网络运作原理</title>
      <link>http://studyai.site/2017/09/24/%E4%B8%8D%E7%94%A8%E4%B8%80%E5%8F%A5%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%9C%AF%E8%AF%AD%E6%9D%A5%E8%AE%B2%E8%A7%A3%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%BF%90%E4%BD%9C%E5%8E%9F%E7%90%86/</link>
      <guid>http://studyai.site/2017/09/24/%E4%B8%8D%E7%94%A8%E4%B8%80%E5%8F%A5%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%9C%AF%E8%AF%AD%E6%9D%A5%E8%AE%B2%E8%A7%A3%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%BF%90%E4%BD%9C%E5%8E%9F%E7%90%86/</guid>
      <pubDate>Sat, 23 Sep 2017 17:11:00 GMT</pubDate>
      <description>
      
        
        
          &lt;blockquote&gt;
&lt;p&gt;原创文章，转载请注明出处&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;神经网络-多层级组织架构的公司&quot;&gt;&lt;a href=&quot;#神经网络-多层级组织架构的公司&quot; class=&quot;headerlink&quot; title=&quot;神经网络==多层级组织架构的公
        
      
      </description>
      
      <content:encoded><![CDATA[<blockquote><p>原创文章，转载请注明出处</p></blockquote><h2 id="神经网络-多层级组织架构的公司"><a href="#神经网络-多层级组织架构的公司" class="headerlink" title="神经网络==多层级组织架构的公司"></a>神经网络==多层级组织架构的公司</h2><p>假设有一家公司，这家公司的组织架构是下面这种多层级的结构：</p><p><img src="/img/17_09_24/001.png" alt=""></p><p>公司每天接待一批固定数量的用户，这些用户会将自己的数据告诉给公司，公司做的事情就是通过每个用户上报的数据来推测当前用户群体整体所表现出来的状态。</p><p><img src="/img/17_09_24/002.png" alt=""></p><p>公司中直接与用户打交道的只有基层业务员，小部门经理只与基层业务员打交道，大部门经理只与小部门经理打交道…依此类推，层层递进，直到CEO这一层。</p><p>并且其中每一个基层业务员会了解每个用户的数据，每个小部门经理也会了解每个基层业务员输出的情况，…，依次类推，直到CEO。而CEO需要了解的是每个副总经理输出的情况。</p><p>公司拿到一批用户的数据之后，首先交给基层业务员。每个基层业务员看到了每个用户的数据之后，都会针对每一个用户出一份数据分析报表（由于每个人的观点不同，所以每个人得出的报表都不一样）；然后每个小部门经理也会分别去看每个业务员输出的报表，然后自己再输出一个针对每一个基层业务员输出的数据的分析报表；同样，每个大部门经理也会去这样看每个小部门经理输出的报表，然后出一份针对每一个小部门经理输出的数据的分析报表；…；以此类推，最终CEO会输出一个针对每一个副总经理输出的数据的分析报表，这份报表里就是公司当前对用户状态的理解。</p><p><img src="/img/17_09_24/003.png" alt=""></p><p>那么公司对用户状态把握到底准确不准确呢？这需要一个衡量标准。</p><p>所以我们需要对公司进行考核，将一部分已知状态的用户数据给到公司，看公司是否能足够准确的预测出这个状态。换句话说，就是CEO最后输出的这份报表，与用户的真实状态之间相差有多大。</p><p><img src="/img/17_09_24/004.png" alt=""></p><p>如果CEO发现自己的预测和真实情况偏差很大，它会带头思考自己工作上到底哪里做的不够好导致最终的判断失误，以及自己需要如何调整状态才能使公司表现更好，然后号召副总经理反思并调整状态。副总经理反思调整之后，会号召他的直属下级部门反思并调整状态。以此类推，直到基层业务员。但其实每个人都不能完全保证调整的状态是否可靠，所以大家就比较保守的<strong>稍微调整一下</strong>自己的工作状态。</p><p>当全公司员工调整状态完成之后，在面对新的用户数据，看是否能更加准确的预测用户群体的状态。如果发现上面的调整确实有效，那么继续按照上面的方式调整：由CEO再次依次号召下面的员工来调整工作状态，调整之后继续面对新的用户。重复执行上面的操作若干次之后，直到公司的预测效果趋于稳定为止（和真实状态对比之后，差值基本不再变化了）。</p><p><img src="/img/17_09_24/005.png" alt=""></p><p>此时的公司就相当于经历了若干次碰壁，并且若干次全员反思、调整状态之后，各个员工都成为了精兵强将了，对于用户数据的把握也更加准确了。</p><p>现在，我们回头看看公司接待的客户。假设公司每天共接待1024位用户，每个用户都举着一个纯色的卡片，卡片颜色是灰度值介于0到255之间的某个颜色。</p><p><img src="/img/17_09_24/006.png" alt=""></p><p>将这些用户按顺序排在32×32的平面上，每个用户占一格。当他们将手里的纯色卡片高举并拼凑起来之后，我们会看到一个写有数字的图片。</p><p><img src="/img/17_09_24/007.png" alt=""></p><p>公司做的事情就是每天接待这1024个用户，他们会告诉公司自己手里卡片的灰度值，但不会告诉公司卡片拼起来的图片是什么，然后公司经过层层分析来得出当前所有用户卡片拼起来的图像是什么。</p><p>这就是一个用户识别手写数字的DNN模型的形象比喻。</p><hr><h3 id="几个问题的思考"><a href="#几个问题的思考" class="headerlink" title="几个问题的思考"></a>几个问题的思考</h3><h4 id="公司员工数量一定的情况下，组织架构是越扁平越好，还是层级越多越好？"><a href="#公司员工数量一定的情况下，组织架构是越扁平越好，还是层级越多越好？" class="headerlink" title="公司员工数量一定的情况下，组织架构是越扁平越好，还是层级越多越好？"></a>公司员工数量一定的情况下，组织架构是越扁平越好，还是层级越多越好？</h4><p>扁平化的架构带来的好处是快速直接触达用户，但最终的准确率会比较低；多层级的架构带来的好处是更合理的分工，但会带来沟通和管理上的开销和数据损失。</p><p>所以如何设置公司层级是一门学问。</p><h4 id="每个员工是如何生成报表的？"><a href="#每个员工是如何生成报表的？" class="headerlink" title="每个员工是如何生成报表的？"></a>每个员工是如何生成报表的？</h4><p>每个员工根据自己对每个数据的重要程度的看法，计算出自己对每个数据的看法。然后在经过一层加工处理之后输出报表。</p><h4 id="公司招聘员工的时候，应该招聘类似的人群，还是招聘差异化的人群？"><a href="#公司招聘员工的时候，应该招聘类似的人群，还是招聘差异化的人群？" class="headerlink" title="公司招聘员工的时候，应该招聘类似的人群，还是招聘差异化的人群？"></a>公司招聘员工的时候，应该招聘类似的人群，还是招聘差异化的人群？</h4><p>应该招聘差异化大的人群，这样每个人能够产生对数据的不同看法。如果公司大部分人背景相似，那么他们对待同一类问题，产生的看法也都相似，没有多样化的观点，也容易导致公司做出错误判断。</p><hr><h3 id="带入术语"><a href="#带入术语" class="headerlink" title="带入术语"></a>带入术语</h3><ul><li>神经网络 -&gt; 多层级结构的公司</li><li>神经网络架构 -&gt; 公司组织架构</li><li>神经元 -&gt; 每一位员工</li><li>损失函数/代价函数 -&gt; 公司最终预测结果 - 真实结果</li><li>输入数据源 -&gt; 每天所有用户的卡片灰度值向量</li><li>输入数据标签值 -&gt; 所有用户卡片拼凑起来的数字图像的真实数值</li><li>反向传播 -&gt; 由CEO牵头，依次带领全公司员工反思</li><li>正向传递 -&gt; 带入每天的用户数据，层层递进，输出最终预测结果</li><li>激活函数 -&gt; 每个员工对数据的加工</li><li>参数 -&gt; 每个员工对数据的主观看法</li><li>随机初始化参数 -&gt; 招聘差异化人群</li><li>输入层 -&gt; 用户层</li><li>隐藏层 -&gt; 除了CEO之外的所有员工层级</li><li>输出层 -&gt; CEO层</li><li>梯度下降 -&gt; 公司朝着缩小预测错误程度的方向全员反思调整状态的过程</li><li>学习率 -&gt; 每次调整状态的程度α</li><li>训练/学习 -&gt; 带入大量已知状态的用户数据来根据公司的预测结果调整全员状态的过程</li></ul><hr><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>神经网络是一个灵活的结构，当带入图片像素值以及图片标签数据时，它训练的就是一个图片识别模型；当带入的数据是邮件特征数据，以及邮件是否为垃圾邮件的类别数据时，它可能就是一个垃圾邮件识别模型。</p><p>这里的类比并不严谨，准确的定义还需要参考标准定义。不过通过形象化的类比，可以使我们对神经网络建立起系统化的认知。</p>]]></content:encoded>
      
      <comments>http://studyai.site/2017/09/24/%E4%B8%8D%E7%94%A8%E4%B8%80%E5%8F%A5%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%9C%AF%E8%AF%AD%E6%9D%A5%E8%AE%B2%E8%A7%A3%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%BF%90%E4%BD%9C%E5%8E%9F%E7%90%86/#disqus_thread</comments>
    </item>
    
    <item>
      <title>【Tensorflow r1.0 程序员指南】-变量：创建，初始化，保存和加载</title>
      <link>http://studyai.site/2017/08/08/%E3%80%90Tensorflow%20r1.0%20%E7%A8%8B%E5%BA%8F%E5%91%98%E6%8C%87%E5%8D%97%E3%80%91-%E5%8F%98%E9%87%8F%EF%BC%9A%E5%88%9B%E5%BB%BA%EF%BC%8C%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%8C%E4%BF%9D%E5%AD%98%E5%92%8C%E5%8A%A0%E8%BD%BD/</link>
      <guid>http://studyai.site/2017/08/08/%E3%80%90Tensorflow%20r1.0%20%E7%A8%8B%E5%BA%8F%E5%91%98%E6%8C%87%E5%8D%97%E3%80%91-%E5%8F%98%E9%87%8F%EF%BC%9A%E5%88%9B%E5%BB%BA%EF%BC%8C%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%8C%E4%BF%9D%E5%AD%98%E5%92%8C%E5%8A%A0%E8%BD%BD/</guid>
      <pubDate>Tue, 08 Aug 2017 14:08:58 GMT</pubDate>
      <description>
      
        
        
          &lt;p&gt;当你训练一个模型时，您可以使用&lt;a href=&quot;https://www.tensorflow.org/api_guides/python/state_ops&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;variables&lt;/a&gt;来保存和更新参数。vari
        
      
      </description>
      
      <content:encoded><![CDATA[<p>当你训练一个模型时，您可以使用<a href="https://www.tensorflow.org/api_guides/python/state_ops" target="_blank" rel="external">variables</a>来保存和更新参数。variables是包含张量的内存缓冲区。variables必须明确地被初始化，并在训练期间和之后将其保存到磁盘。在之后您可以恢复保存的值，以运行或分析模型。</p><p>本文档引用了以下TensorFlow类。请参阅其参考手册的链接，了解其API的完整说明：</p><ul><li><a href="https://www.tensorflow.org/api_docs/python/tf/Variable" target="_blank" rel="external">tf.Variable</a></li><li><a href="https://www.tensorflow.org/api_docs/python/tf/train/Saver" target="_blank" rel="external">tf.train.Saver</a></li></ul><h2 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h2><p>当您创建一个<a href="https://www.tensorflow.org/api_guides/python/state_ops" target="_blank" rel="external">Variable</a>时，您将<code>Tensor</code>作为其初始值传递给<code>Variable()</code>构造函数。TensorFlow提供了一个操作的集合，它们产生经常用于从<a href="https://www.tensorflow.org/api_guides/python/constant_op" target="_blank" rel="external">常量或随机初始化的</a>张量。</p><p>请注意，所有这些操作都需要您指定张量的形状。该形状自动变为变量的形状。变量通常具有固定的形状，但是TensorFlow提供了重新变换变量的高级机制。</p>]]></content:encoded>
      
      <comments>http://studyai.site/2017/08/08/%E3%80%90Tensorflow%20r1.0%20%E7%A8%8B%E5%BA%8F%E5%91%98%E6%8C%87%E5%8D%97%E3%80%91-%E5%8F%98%E9%87%8F%EF%BC%9A%E5%88%9B%E5%BB%BA%EF%BC%8C%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%8C%E4%BF%9D%E5%AD%98%E5%92%8C%E5%8A%A0%E8%BD%BD/#disqus_thread</comments>
    </item>
    
  </channel>
</rss>
